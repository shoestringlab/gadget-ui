"use strict";var gadgetui={keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}};document.addEventListener("mousemove",function(t){t=t||window.event,gadgetui.mousePosition=gadgetui.util.mouseCoords(t)}),gadgetui.model=function(t){var e={};function i(t,e){this.data=t,this.elements=[],void 0!==e&&this.bind(e)}return i.prototype.handleEvent=function(e){var i,o;switch(e.type){case"change":for(i=0;i<this.elements.length;i++)o=this.elements[i],void 0===e.originalSource&&(e.originalSource="BindableObject.handleEvent['change']"),e.target.name===o.prop&&"BindableObject.updateDomElement"!==e.originalSource&&(e.target.type.match(/select/)?this.change({id:t(e.target).val(),text:t(e.target).find("option:selected").text()},e,o.prop):this.change(e.target.value,e,o.prop))}},i.prototype.change=function(t,e,i){var o,s;if(void 0===e.originalSource&&(e.originalSource="BindableObject.change"),console.log("change : Source: "+e.originalSource),void 0===i)this.data=t;else{if("object"!=typeof this.data)throw"Attempt to treat a simple value as an object with properties. Change fails.";if(void 0===this.data[i])throw"Property '"+i+"' of object is undefined.";this.data[i]=t}for(o=0;o<this.elements.length;o++)s=this.elements[o],void 0!==i&&i!==s.prop||void 0===e.target||s.elem[0]===e.target||this.updateDomElement(e,s.elem,t)},i.prototype.updateDom=function(t,e,i){var o,s,a;for(void 0===t.originalSource&&(t.originalSource="BindableObject.updateDom"),o=0;o<this.elements.length;o++)if(s=this.elements[o],void 0===i)if("object"==typeof e)for(a in e)this.elements[o].prop===a&&this.updateDomElement(t,s.elem,e[a]);else this.updateDomElement(t,s.elem,e);else s.prop===i&&this.updateDomElement(t,s.elem,e)},i.prototype.updateDomElement=function(e,i,o){if(void 0===e.originalSource&&(e.originalSource="BindableObject.updateDomElement"),console.log("updateDomElement : selector: { type: "+i[0].nodeName+", name: "+i[0].name+" }"),console.log("updateDomElement : Source: "+e.originalSource),"object"==typeof o?!0===i.is("div")||!0===i.is("span")?i.text(o.text):i.val(o.id):!0===i.is("div")||!0===i.is("span")?i.text(o):i.val(o),"model.set"!==e.originalSource){var s=t.Event("change");s.originalSource="BindableObject.updateDomElement",i.trigger(s)}},i.prototype.bind=function(t,e){var i,o=this;void 0===e?(t.val(this.data),i={elem:t,prop:""}):(t.val(this.data[e]),i={elem:t,prop:e}),t[0].addEventListener?t[0].addEventListener("change",this,!1):t[0].attachEvent("onpropertychange",function(t){if("value"===t.propertyName){var e=t.srcElement,i="SELECT"===e.nodeName?{id:e.value,text:e.options[e.selectedIndex].innerHTML}:e.value;o.change(i,{target:e},e.name)}}),this.elements.push(i)},{BindableObject:i,create:function(t,o,s){e[t]=void 0!==s?new i(o,s):new i(o)},destroy:function(t){delete e[t]},bind:function(t,i){var o=t.split(".");1===o.length?e[t].bind(i):e[o[0]].bind(i,o[1])},exists:function(t){return!!e.hasOwnProperty(t)},get:function(t){var i=t.split(".");try{if(1===i.length){if(void 0===e[t])throw"Key '"+t+"' does not exist in the model.";return e[t].data}if(void 0===e[i[0]])throw"Key '"+i[0]+"' does not exist in the model.";return e[i[0]].data[i[1]]}catch(t){return void console.log(t)}},set:function(t,i){if(null!==t&&void 0!==t){var o=t.split("."),s={originalSource:"model.set"};if(!1===this.exists(o[0])){if(1!==o.length)throw"Object "+o[0]+"is not yet initialized.";this.create(t,i)}else 1===o.length?(e[t].change(i,s),e[t].updateDom(s,i)):(e[o[0]].change(i,s,o[1]),e[o[0]].updateDom(s,i,o[1]));console.log("model value set: name: "+t+", value: "+i)}else console.log("Expected parameter [name] is not defined.")}}}(jQuery),$.gadgetui={},$.gadgetui.textWidth=function(t,e){$.gadgetui.textWidth.fakeEl||($.gadgetui.textWidth.fakeEl=$('<span id="gadgetui-textWidth">').appendTo(document.body));var i,o=t||$.fn.val()||$.fn.text();return o.length>0&&(o=void 0===(o=$.gadgetui.textWidth.fakeEl.text(o).html())?"":o.replace(/\s/g,"&nbsp;")),$.gadgetui.textWidth.fakeEl.html(o).css("font",e||$.fn.css("font")),$.gadgetui.textWidth.fakeEl.css("display","inline"),i=$.gadgetui.textWidth.fakeEl.width(),$.gadgetui.textWidth.fakeEl.css("display","none"),i},$.gadgetui.fitText=function(t,e,i){var o,s=$.gadgetui.textWidth(t,e),a=$.gadgetui.textWidth("...",e);if(s<i)return t;for(o=Math.floor(t.length/2)-1;s+a>=i;)t=t.slice(0,o)+t.slice(o+1,t.length),o=Math.floor(t.length/2)-1,s=$.gadgetui.textWidth(t,e);for(o=Math.floor(t.length/2)-1,t=t.slice(0,o)+"..."+t.slice(o,t.length);" "===t.substring(o-1,o);)t=t.slice(0,o-1)+t.slice(o,t.length),o-=1;for(;" "===t.substring(o+3,o+4);)t=t.slice(0,o+3)+t.slice(o+4,t.length),o-=1;return t},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var i,o,s,a,r=Object(this),n=r.length>>>0;if("function"!=typeof t)throw new TypeError;for(i=e||void 0,o=0;o<n;)s=o.toString(),r.hasOwnProperty(s)&&(a=r[s],t.call(i,a,o,r)),o+=1}),gadgetui.display=function(t){function e(t,e,i){this.selector=t,this.message=e,this.config(i),this.render(),this.setStyles(),this.setBehaviors(),this.show()}function i(e,i){this.selector=e,void 0!==i&&this.config(i),this.addControl(),this.wrapper=t(this.selector).parent(),this.addCSS(),this.addHeader(),this.icon=t("div div",this.wrapper),this.addBindings(),!0===this.collapse&&this.toggle()}function o(t,e){var i,o,s,a=gadgetui.objects.EventBindings.getAll();for(s={id:o=gadgetui.util.Id(),filename:t.name,width:e.width()},this.file=t,this.id=o,this.progressbar=gadgetui.objects.Constructor(gadgetui.display.ProgressBar,[e,s]),this.progressbar.render(),i=0;i<a.length;i++)this[a[i].name]=a[i].func}function s(e,i){this.selector=e,void 0!==i&&this.config(i),this.addControl(),this.wrapper=t(this.selector).parent(),this.addHeader(),this.maxmin=t("div div[class='oi']",this.wrapper),this.minWidth=this.title.length>0?gadgetui.util.textWidth(this.title,this.header[0].style)+50:100,this.addCSS(),this.height=gadgetui.util.getStyle(t(this.selector).parent(),"height"),this.relativeOffsetLeft=gadgetui.util.getRelativeParentOffset(this.selector).left,this.addBindings()}function a(t,e){this.selector=t,this.configure(e)}return e.prototype.render=function(){var t='<div class="gadgetui-bubble gadgetui-bubble-'+this.bubbleType+'" id="'+this.id+'">'+this.message;this.closable&&(t+='<span class="ui-icon ui-icon-close"></span>'),t+='<div class="gadgetui-bubble-arrow-outside"></div><div class="gadgetui-bubble-arrow-inside"></div></div>',this.selector.after(t)},e.prototype.show=function(){this.bubbleSelector.show("fade",500)},e.prototype.setStyles=function(){this.setBubbleStyles(),this.calculateArrowPosition(),this.calculateArrowStyle(),this.setBeforeRules(),this.setAfterRules(),this.calculatePosition(),this.bubbleSelector.css("top",this.top).css("left",this.left),t("span",this.bubbleSelector).css("left",this.bubbleWidth-6-this.closeIconSize-2*this.borderWidth).css("position","absolute").css("cursor","pointer").css("top",6)},e.prototype.setBubbleStyles=function(){this.bubbleSelector=t("#"+this.id),this.bubbleSelector.css("margin",0).css("padding",this.padding).css("width",this.width).css("height",this.height).css("line-height",this.lineHeight+"px").css("border-radius",this.borderRadius).css("-moz-border-radius",this.borderRadius).css("-webkit-border-radius",this.borderRadius).css("-webkit-box-shadow",this.shadowSize+"px "+this.shadowSize+"px 4px "+this.boxShadowColor).css("-moz-box-shadow",this.shadowSize+"px "+this.shadowSize+"px 4px "+this.boxShadowColor).css("box-shadow",this.shadowSize+"px "+this.shadowSize+"px 4px "+this.boxShadowColor).css("border",this.borderWidth+"px solid "+this.borderColor).css("background-color",this.backgroundColor).css("position","absolute").css("text-align","left").css("opacity",this.opacity).css("font",this.font).css("z-index",this.zIndex)},e.prototype.setBeforeRules=function(){var e={content:" ",position:"absolute",width:0,height:0,left:this.beforeArrowLeft+"px",top:this.arrowTop+"px",border:this.arrowSize+"px solid",borderColor:this.beforeBorderColor};t("div[class='gadgetui-bubble-arrow-outside']",t("#"+this.id)).addRule(e,0)},e.prototype.setAfterRules=function(){var e={content:" ",position:"absolute",width:0,height:0,left:this.afterArrowLeft+"px",top:this.afterArrowTop+"px",border:this.afterArrowSize+"px solid",borderColor:this.afterBorderColor};t("div[class='gadgetui-bubble-arrow-inside']",t("#"+this.id)).addRule(e,0)},e.prototype.calculatePosition=function(){var e=this;this.relativeOffset=gadgetui.util.getRelativeParentOffset(this.selector),t.each(this.position.split(" "),function(t,i){switch(i){case"top":e.top=e.top-e.relativeOffset.top;break;case"bottom":e.top=e.top+e.selector.outerHeight()-e.relativeOffset.top;break;case"left":break;case"right":e.left=e.left+e.selector.outerWidth()-e.relativeOffset.left;break;case"center":e.left=e.left+e.selector.outerWidth()/2-e.relativeOffset.left}})},e.prototype.calculateArrowPosition=function(){var t,e=2*this.arrowSize,i=2*this.padding,o=this.borderWidth+this.borderRadius+this.arrowSize,s=Math.floor(Math.sqrt(Math.pow(this.borderWidth,2)+Math.pow(this.borderWidth,2)))-1;switch(this.afterArrowSize=this.arrowSize-s,t=(e-2*this.afterArrowSize)/2,this.arrowPositionArray[0]){case"left":this.beforeArrowLeft=-e,this.afterArrowLeft=2*-this.afterArrowSize,this.left=this.left+this.arrowSize-this.borderWidth;break;case"right":this.beforeArrowLeft=this.width+i,this.afterArrowLeft=this.beforeArrowLeft,this.left=this.left-this.bubbleWidth-this.arrowSize+this.borderWidth;break;case"top":this.arrowTop=-e,this.afterArrowTop=-2*this.afterArrowSize,this.top=this.top+this.arrowSize-this.borderWidth;break;case"bottom":this.arrowTop=this.height+i,this.afterArrowTop=this.arrowTop,this.top=this.top-this.bubbleHeight-this.arrowSize+this.borderWidth}switch(this.arrowPositionArray[1]){case"top":this.arrowTop=this.borderRadius,this.afterArrowTop=this.arrowTop+t,this.top=this.top-o;break;case"bottom":this.arrowTop=this.bubbleHeight-2*this.borderWidth-e-this.borderRadius,this.afterArrowTop=this.arrowTop+t,this.top=this.top-this.bubbleHeight+o;break;case"right":this.beforeArrowLeft=this.bubbleWidth-2*this.borderWidth-e-this.borderRadius,this.afterArrowLeft=this.beforeArrowLeft+s,this.left=this.left-this.bubbleWidth+o;break;case"left":this.beforeArrowLeft=this.borderRadius,this.afterArrowLeft=this.beforeArrowLeft+s,this.left=this.left-o}},e.prototype.calculateArrowStyle=function(){var t=[],e=this.arrowPositionArray[0],i=this.arrowPositionArray[1]+" "+this.arrowDirection;if("middle"===this.arrowDirection)switch(this.arrowPositionArray[0]){case"top":this.beforeBorderColor="transparent transparent "+this.borderColor+" transparent",this.afterBorderColor="transparent transparent #fff transparent";break;case"bottom":this.beforeBorderColor=this.borderColor+" transparent transparent transparent",this.afterBorderColor="#fff transparent transparent transparent";break;case"right":this.beforeBorderColor="transparent transparent transparent "+this.borderColor,this.afterBorderColor="transparent transparent transparent #fff";break;case"left":this.beforeBorderColor="transparent "+this.borderColor+" transparent transparent",this.afterBorderColor="transparent #fff transparent transparent"}else"top"===e||"bottom corner"===i||"top center"===i?(t[0]="transparent",t[2]=this.borderColor):"bottom"!==e&&"bottom center"!==i&&"top corner"!==i||(t[0]=this.borderColor,t[2]="transparent"),"right"===e||"left corner"===i||"right center"===i?(t[1]="transparent",t[3]=this.borderColor):"left"!==e&&"left center"!==i&&"right corner"!==i||(t[1]=this.borderColor,t[3]="transparent"),this.beforeBorderColor=t.toString().replace(/\),/gi,") ").replace(/,transparent/gi," transparent").replace(/transparent,/gi,"transparent "),this.afterBorderColor=this.beforeBorderColor.replace(this.borderColor,"#fff","g")},e.prototype.setBehaviors=function(){var e=this;t("span",this.bubbleSelector).on("click",function(){e.bubbleSelector.hide("fade").remove()}),this.autoClose&&(closeBubble=function(){e.bubbleSelector.hide("fade").remove()},setTimeout(closeBubble,this.autoCloseDelay))},e.prototype.config=function(t){var e=function(t,e,i){for(var o=void 0!==i?[i]:document.styleSheets,s=0,a=o.length;s<a;s++)if((i=o[s]).cssRules)for(var r=0,n=i.cssRules.length;r<n;r++){var l=i.cssRules[r];if(l.selectorText&&-1!==l.selectorText.split(",").indexOf(e))return l.style[t]}return null}("color",".ui-state-active");this.bubbleType=void 0===t.bubbleType?"speech":t.bubbleType,this.id="gadgetui-bubble-"+gadgetui.util.Id(),this.height=void 0===t.height?100:t.height,this.position=void 0===t.position?"top right":t.position,this.width=void 0===t.width?200:t.width,this.padding=void 0===t.padding?20:t.padding,this.opacity=void 0===t.opacity?1:t.opacity,this.top=this.selector.offset().top,this.left=this.selector.offset().left,this.shadowColor=void 0===t.shadowColor?e:t.shadowColor,this.shadowSize=2,this.borderColor=void 0===t.borderColor?e:t.borderColor,this.borderWidth=void 0===t.borderWidth?8:t.borderWidth,this.arrowPosition=void 0===t.arrowPosition?"bottom left":t.arrowPosition,this.arrowDirection=void 0===t.arrowDirection?"middle":t.arrowDirection,this.arrowPositionArray=this.arrowPosition.split(" "),this.bubbleWidth=this.width+2*this.padding+2*this.borderWidth,this.bubbleHeight=this.height+2*this.padding+2*this.borderWidth,this.closeIconSize=16,this.arrowSize=void 0===t.arrowSize?25:t.arrowSize,this.backgroundColor=void 0===t.backgroundColor?"#FFFFFF":t.backgroundColor,this.lineHeight=void 0===t.lineHeight?"1.2em":t.lineHeight,this.borderRadius=void 0===t.borderRadius?30:t.borderRadius,this.boxShadowColor=void 0===t.boxShadowColor?e:t.boxShadowColor,this.font=void 0===t.font?"1em Arial sans":t.font,this.zIndex=void 0===t.zIndex?100:t.zIndex,this.closable=void 0!==t.closable&&t.closable,this.autoClose=void 0!==t.autoClose&&t.autoClose,this.autoCloseDelay=void 0===t.autoCloseDelay?5e3:t.autoCloseDelay,this.relativeOffset={left:0,top:0}},i.prototype.addBindings=function(){var e=this;t("div.gadget-ui-collapsiblePane-header",this.wrapper).on("click",function(){e.toggle()})},i.prototype.addHeader=function(){this.wrapper.prepend('<div class="ui-widget-header ui-corner-all gadget-ui-collapsiblePane-header">'+this.title+'<div class="ui-icon ui-icon-triangle-1-n"></div></div>')},i.prototype.addCSS=function(){this.wrapper.css("width",this.width),t(this.selector).css("width",this.interiorWidth).css("padding",this.padding)},i.prototype.addControl=function(){t(this.selector).wrap('<div class="gadget-ui-collapsiblePane ui-corner-all ui-widget-content"></div>')},i.prototype.config=function(e){this.title=void 0===e.title?"":e.title,this.path=void 0===e.path?"/bower_components/gadget-ui/dist/":e.path,this.padding=void 0===e.padding?".5em":e.padding,this.paddingTop=void 0===e.paddingTop?".3em":e.paddingTop,this.width=void 0===e.width?t(this.selector).css("width"):e.width,this.interiorWidth=void 0===e.interiorWidth?"":e.interiorWidth,this.collapse=void 0!==e.collapse&&!1!==e.collapse},i.prototype.toggle=function(){var e,i,o=this;"none"===o.selector.css("display")?(e="ui-icon-triangle-1-n",i="ui-icon-triangle-1-s"):(e="ui-icon-triangle-1-s",i="ui-icon-triangle-1-n"),o.eventName=void 0===o.eventName||"collapse"===o.eventName?"expand":"collapse",o.selector.css("padding",o.padding).css("padding-top",o.paddingTop).toggle("blind",{},200,function(){t(o.icon).addClass(e).removeClass(i),t(this).css("padding",o.padding),o.selector.trigger(o.eventName)})},o.prototype.events=["uploadComplete"],o.prototype.completeUpload=function(t){this.progressbar.destroy(),this.fireEvent("uploadComplete",t)},s.prototype.addBindings=function(){var t=this;this.wrapper.draggable({addClasses:!1}),this.maxmin.on("click",function(){t.minimized?t.expand():t.minimize()})},s.prototype.addHeader=function(){this.wrapper.prepend('<div class="ui-widget-header ui-corner-all gadget-ui-floatingPane-header">'+this.title+'<div class="oi"></div></div>'),t("div[class='oi']",this.wrapper).attr("data-glyph","fullscreen-exit"),this.header=t("div[class~='gadget-ui-floatingPane-header']",this.wrapper)},s.prototype.addCSS=function(){this.wrapper.css("width",this.width).css("minWidth",this.minWidth).css("opacity",this.opacity).css("z-index",this.zIndex).css("background",this.selector.css("background")).css("background-color",this.selector.css("background-color")),t(this.selector).css("width",this.interiorWidth).css("padding",this.padding),this.maxmin.css("float","left").css("display","inline")},s.prototype.addControl=function(){t(this.selector).wrap('<div class="gadget-ui-floatingPane ui-corner-all ui-widget-content"></div>')},s.prototype.config=function(e){this.title=void 0===e.title?"":e.title,this.path=void 0===e.path?"/bower_components/gadget-ui/dist/":e.path,this.position=void 0===e.position?{my:"right top",at:"right top",of:window}:e.position,this.padding=void 0===e.padding?"15px":e.padding,this.paddingTop=void 0===e.paddingTop?".3em":e.paddingTop,this.width=void 0===e.width?t(this.selector).css("width"):e.width,this.height=void 0===e.height?gadgetui.util.getNumberValue(gadgetui.util.getStyle(t(this.selector),"height"))+2*gadgetui.util.getNumberValue(this.padding):e.height,this.interiorWidth=void 0===e.interiorWidth?"":e.interiorWidth,this.opacity=void 0===e.opacity?1:e.opacity,this.zIndex=void 0===e.zIndex?1e5:e.zIndex,this.minimized=!1,this.relativeOffsetLeft=0},s.prototype.expand=function(){var e=this,i=t(this.wrapper).offset();parseInt(new Number(i.left),10),this.relativeOffsetLeft;NaN!==parseInt(this.width)?this.width:parseInt(this.width.substr(0,this.width.length-2),10),this.wrapper.animate({width:this.width},{queue:!1,duration:500},function(){}),this.wrapper.animate({height:this.height},{queue:!1,duration:500,complete:function(){e.maxmin.attr("data-glyph","fullscreen-exit")}}),this.minimized=!1},s.prototype.minimize=function(){var e=this,i=t(this.wrapper).offset();parseInt(new Number(i.left),10),this.relativeOffsetLeft;NaN!==parseInt(this.width)?this.width:parseInt(this.width.substr(0,this.width.length-2),10),this.wrapper.animate({width:e.minWidth},{queue:!1,duration:500,complete:function(){e.maxmin.attr("data-glyph","fullscreen-enter")}}),this.wrapper.animate({height:"50px"},{queue:!1,duration:500},function(){}),this.minimized=!0},a.prototype.configure=function(t){this.id=t.id,this.filename=t.filename,this.width=t.width},a.prototype.render=function(){t(this.selector).append('<div class="gadgetui-progressbar-progressbox" name="progressbox_'+this.id+'" style="display:none;"><div name="filename" class="gadgetui-progressbar-filename">'+this.filename+'</div><div class="progressbar" name="progressbar_'+this.id+'"></div ><div name="statustxt" class="statustxt">0%</div></div>'),this.progressbox=t("div[name='progressbox_"+this.id+"']",this.selector),this.progressbar=t("div[name='progressbar_"+this.id+"']",this.selector),this.statustxt=t("div[name='statustxt']",t("div[name='progressbox_"+this.id+"']",this.selector)),this.progressbox.css("display","inline-block").css("width",this.width)},a.prototype.start=function(){this.progressbar.width(0),this.statustxt.html("0%")},a.prototype.updatePercent=function(t){var e=t+"%";this.percent=t,this.progressbar.width(e),this.statustxt.html(e),t>50&&this.statustxt.css("color","#fff")},a.prototype.update=function(t){this.statustxt.html(t)},a.prototype.destroy=function(){this.progressbox.remove()},{Bubble:e,CollapsiblePane:i,FileUploadWrapper:o,FloatingPane:s,ProgressBar:a}}(jQuery),gadgetui.input=function(t){function e(t,e){this.emitEvents=!0,this.model=gadgetui.model,this.func,this.selector=t,this.config(e),this.setSaveFunc(),this.setDataProviderRefresh(),this.addControl(),this.setCSS(),gadgetui.util.bind(this.selector,this.model),gadgetui.util.bind(this.label,this.model),this.addBehaviors(),this.setStartingValues()}function i(t,e){this.selector=t,this.dlg="",this.droppedFiles=[],this.configure(e),this.render(e.title),this.setEventHandlers(),this.dlg.dialog("open"),this.setDimensions()}function o(e,i){function o(t){return t.label}this.itemRenderer=o,this.menuItemRenderer=o,this.emitEvents=!0,this.selector=e,void 0!==i&&this.config(i),t(this.selector).wrap('<div class="gadgetui-lookuplist-input-div ui-widget-content ui-corner-all"></div>'),this.addBindings()}function s(t,e){this.selector=t,this.config(e),this.setInitialValue(),this.addControl(),this.addCSS(),this.selector.css("display","none"),gadgetui.util.bind(this.selector,this.model),gadgetui.util.bind(this.label,this.model),this.addBindings()}function a(t,e){this.emitEvents=!0,this.model=gadgetui.model,this.func,this.selector=t,this.config(e),this.setInitialValue(),this.addControl(),this.setLineHeight(),this.setFont(),this.setMaxWidth(),this.setWidth(),this.addCSS(),gadgetui.util.bind(this.selector,this.model),gadgetui.util.bind(this.label,this.model),this.addBindings()}return e.prototype.addControl=function(){t(this.selector).wrap("<div class='gadgetui-combobox'></div>").wrap("<div class='gadgetui-combobox-selectwrapper'></div>").parent().parent().append("<div class='gadgetui-combobox-inputwrapper'><input class='gadgetui-combobox-input' value='' name='custom' type='text' placeholder='"+this.newOption.text+"'/></div>").prepend("<div class='gadgetui-combobox-label' data-id='"+this.id+"'>"+this.text+"</div>"),this.comboBox=t(this.selector).parent().parent(),this.input=t("input[class='gadgetui-combobox-input']",t(this.selector).parent().parent()),this.label=t("div[class='gadgetui-combobox-label']",t(this.selector).parent().parent()),this.label.attr("gadgetui-bind",this.selector.attr("gadgetui-bind")),this.inputWrapper=t("div[class='gadgetui-combobox-inputwrapper']",t(this.selector).parent().parent()),this.selectWrapper=t("div[class='gadgetui-combobox-selectwrapper']",t(this.selector).parent().parent()),this.comboBox.css("opacity",".0"),t.isFunction(this.input.placeholder)&&this.input.placeholder()},e.prototype.setCSS=function(){var t=this,e=new Promise(function(e,i){t.getArrowWidth(e,i)});e.then(function(){t.addCSS()}),e.catch(function(e){t.arrowWidth=22,console.log(e),t.addCSS()})},e.prototype.getArrowWidth=function(t,e){var i=this,o=new Image;o.onload=function(){i.arrowWidth=this.width,t()},o.onerror=function(){e("Icon was not loaded.")},o.src=this.arrowIcon},e.prototype.addCSS=function(){this.selector.addClass("gadgetui-combobox-select").css("width",this.width).css("border",0).css("display","inline"),this.comboBox.css("position","relative");var t,e,i,o=gadgetui.util.getStyle(this.selector),s=(gadgetui.util.getStyle(this.selectWrapper),this.selector[0].clientWidth),a=0,r=0,n=this.borderWidth;i=this.borderWidth+4,this.borderRadius>5&&(i+=r=this.borderRadius-5),e=i,t=s-this.arrowWidth-this.borderRadius-4,console.log(navigator.userAgent),navigator.userAgent.match(/(Safari)/)&&!navigator.userAgent.match(/(Chrome)/)?(n=this.borderWidth-2,r=r<4?4:this.borderRadius-1,a=1):navigator.userAgent.match(/Edge/)?(r=r<1?1:this.borderRadius-4,e--):navigator.userAgent.match(/MSIE/)?r=r<1?1:this.borderRadius-4:navigator.userAgent.match(/Trident/)?r=r<2?2:this.borderRadius-3:navigator.userAgent.match(/Chrome/)&&(r=r<4?4:this.borderRadius-1,a=1),this.selector.css("margin-top",a).css("padding-left",r),this.inputWrapper.css("position","absolute").css("top",n).css("left",0),this.input.css("display","inline").css("padding-left",0).css("margin-left",e).css("width",t),this.label.css("position","absolute").css("left",i).css("top",this.borderWidth+1).css("margin-left",0),this.selectWrapper.css("display","inline").css("position","absolute").css("padding-bottom","1px").css("left",0),this.comboBox.css("font-size",o.fontSize),this.selectWrapper.css("background-color",this.backgroundColor).css("border",this.border).css("border-radius",this.borderRadius),this.input.css("border",0).css("font-size",o.fontSize).css("background-color",this.inputBackground),this.label.css("font-family",o.fontFamily).css("font-size",o.fontSize).css("font-weight",o.fontWeight),navigator.userAgent.match(/Firefox/)&&(this.selectWrapper.css("background-image","url("+this.arrowIcon+")").css("background-repeat","no-repeat").css("background-position","right center"),!0===this.scaleIconHeight&&this.selectWrapper.css("background-size",this.arrowWidth+"px "+inputHeight+"px")),this.selector.css("-webkit-appearance","none").css("-moz-appearance","window").css("background-image","url('"+this.arrowIcon+"')").css("background-repeat","no-repeat").css("background-position","right center"),!0===this.scaleIconHeight&&this.selectWrapper.css("background-size",this.arrowWidth+"px "+inputHeight+"px"),this.inputWrapper.hide(),this.selectWrapper.hide(),this.comboBox.css("opacity","1")},e.prototype.setSelectOptions=function(){var e,i,o=this;t(o.selector).empty(),t(o.selector).append("<option value='"+o.newOption.id+"'>"+o.newOption.text+"</option>"),t.each(this.dataProvider.data,function(s,a){e=a.id,void 0===(i=a.text)&&(i=e),t(o.selector).append("<option value="+e+">"+i)})},e.prototype.find=function(t){var e;for(e=0;e<this.dataProvider.data.length;e++)if(this.dataProvider.data[e].text===t)return this.dataProvider.data[e].id},e.prototype.getText=function(t){var e,i=parseInt(t,10);for(!0===isNaN(i)&&(i=t),e=0;e<this.dataProvider.data.length;e++)if(this.dataProvider.data[e].id===i)return this.dataProvider.data[e].text},e.prototype.showLabel=function(){this.label.css("display","inline-block"),this.selectWrapper.hide(),this.inputWrapper.hide()},e.prototype.addBehaviors=function(e){var i=this;t(this.comboBox).on(this.activate,function(){setTimeout(function(){"none"!=i.label.css("display")&&(console.log("combo mouseenter "),i.selectWrapper.css("display","inline"),i.label.css("display","none"),i.selector.prop("selectedIndex")<=0&&i.inputWrapper.css("display","inline"))},i.delay)}).on("mouseleave",function(){console.log("combo mouseleave "),!1===i.selector.is(":focus")&&!1===i.input.is(":focus")&&i.showLabel()}),i.input.on("click",function(t){console.log("input click ")}).on("keyup",function(t){if(console.log("input keyup"),13===t.which){var e=gadgetui.util.encode(i.input.val());i.handleInput(e)}}).on("blur",function(){console.log("input blur"),!0===gadgetui.util.mouseWithin(i.selector,gadgetui.mousePosition)?(i.inputWrapper.hide(),i.selector.focus()):i.showLabel()}),this.selector.on("mouseenter",function(t){i.selector.css("display","inline")}).on("click",function(t){console.log("select click"),t.stopPropagation()}).on("change",function(e){var o=e.target.selectedIndex>=0?e.target.selectedIndex:0;parseInt(e.target[o].value,10)!==parseInt(i.id,10)&&(console.log("select change"),e.target.selectedIndex>0?(i.inputWrapper.hide(),i.setValue(e.target[e.target.selectedIndex].value)):(i.inputWrapper.show(),i.setValue(i.newOption.value),i.input.focus()),t(i.selector).trigger("gadgetui-combobox-change",[{id:e.target[e.target.selectedIndex].value,text:e.target[e.target.selectedIndex].innerHTML}]),console.log("label:"+i.label.text()))}).on("blur",function(t){console.log("select blur "),t.stopPropagation(),setTimeout(function(){!1===i.input.is(":focus")&&i.showLabel()},200)}),t("option",this.selector).on("mouseenter",function(t){console.log("option mouseenter"),"inline"!==i.selector.css("display")&&i.selector.css("display","inline")})},e.prototype.handleInput=function(t){var e=this.find(t);void 0!==e?(this.selector.val(e),this.label.text(t),this.selector.focus(),this.input.val(""),this.inputWrapper.hide()):void 0===e&&t.length>0&&this.save(t)},e.prototype.triggerSelectChange=function(){console.log("select change");var t=new Event("change",{view:window,bubbles:!0,cancelable:!0});this.selector[0].dispatchEvent(t)},e.prototype.setSaveFunc=function(){if(!0===t.isFunction(this.save)){var e=this.save;this.save=function(t){var i,o,s=this,a=[t];return void 0===this.find(t)&&(console.log("save: "+t),(o=new Promise(function(t,o){a.push(t),a.push(o),i=e.apply(s,a),console.log(i)})).then(function(e){function i(){s.selector.trigger("gadgetui-combobox-save",{id:e,text:t}),s.input.val(""),s.inputWrapper.hide(),s.id=e,s.dataProvider.refresh()}!0===s.animate?(s.selectWrapper.animate({boxShadow:"0 0 5px "+s.glowColor,borderColor:s.glowColor},s.animateDelay/2),s.selectWrapper.animate({boxShadow:0,borderColor:s.borderColor},s.animateDelay/2,i)):i()}),o.catch(function(t){s.input.val(""),s.inputWrapper.hide(),console.log(t),s.dataProvider.refresh()})),i}}},e.prototype.setStartingValues=function(){void 0===this.dataProvider.data?this.dataProvider.refresh():this.setControls()},e.prototype.setControls=function(){console.log(this),this.setSelectOptions(),this.setValue(this.id),this.triggerSelectChange()},e.prototype.setValue=function(t){var e=this.getText(t);console.log("setting id:"+t),this.id=void 0===e?this.newOption.id:t,e=void 0===e?this.newOption.text:e,this.text=e,this.label.text(this.text),this.selector.val(this.id)},e.prototype.setDataProviderRefresh=function(){var e,i,o=this,s=this.dataProvider.refresh;this.dataProvider.refresh=function(){var a=this;return!0===t.isFunction(s)&&((e=new Promise(function(t,e){var o=[a,t,e];i=s.apply(this,o)})).then(function(){o.selector.trigger("gadgetui-combobox-refresh"),o.setControls()}),e.catch(function(t){console.log("message"),o.setControls()})),i}},e.prototype.config=function(t){void 0!==t&&(this.model=void 0===t.model?this.model:t.model,this.emitEvents=void 0===t.emitEvents||t.emitEvents,this.dataProvider=void 0===t.dataProvider?void 0:t.dataProvider,this.save=void 0===t.save?void 0:t.save,this.activate=void 0===t.activate?"mouseenter":t.activate,this.delay=void 0===t.delay?10:t.delay,this.inputBackground=void 0===t.inputBackground?"#ffffff":t.inputBackground,this.borderWidth=void 0===t.borderWidth?1:t.borderWidth,this.borderColor=void 0===t.borderColor?"#d0d0d0":t.borderColor,this.borderStyle=void 0===t.borderStyle?"solid":t.borderStyle,this.borderRadius=void 0===t.borderRadius?5:t.borderRadius,this.border=this.borderWidth+"px "+this.borderStyle+" "+this.borderColor,this.width=void 0===t.width?150:t.width,this.newOption=void 0===t.newOption?{text:"...",id:0}:t.newOption,this.id=void 0===t.id?this.newOption.id:t.id,this.arrowIcon=void 0===t.arrowIcon?"/bower_components/gadget-ui/dist/img/arrow.png":t.arrowIcon,this.scaleIconHeight=void 0!==t.scaleIconHeight&&t.scaleIconHeight,this.animate=void 0===t.animate||t.animate,this.glowColor=void 0===t.glowColor?"rgb(82, 168, 236)":t.glowColor,this.animateDelay=void 0===t.animateDelay?500:t.animateDelay)},i.prototype.render=function(e){var i,o,s=this,a=function(o){i={title:e,close:"Close",addFile:"Add a File",dropMessage:"Drop files here or click 'Add a File' ",fileSelectLbl:""},t("div[name='"+o.name+"']",s.selector).html('<div style="padding:10px;"><div name="dropzone" class="gadgetui-filedialog-dropzone" id="dropzone"><p>'+i.dropMessage+'</p></div><div name="filedisplay" class="gadgetui-filedialog-filedisplay" style="display:none;"></div><div class="buttons full"><div class="fileUpload"><input type="file" name="fileselect" class="upload" title="'+i.fileSelectLbl+'"></div><input type="button" class="ui-corner-all btn btn-primary" name="close" value="'+i.close+'"/></div></div>'),s.renderDropZone(o)};if({title:e=e,close:"Close",tabs:s.tabs},s.tabs.length>1){o='<div name="filedialogTabs" class="gadgetui-filedialog-tabdialog"><ul>';var r="",n="";t.each(s.tabs,function(t,e){r+='<li><a href="#'+e.id+'">'+e.name+"</a></li>",n+='<div id="'+e.id+'" name="'+e.name+'"></div>'}),o+=r+"</ul>"+n+"</div>"}else o='<div id="'+s.tabs[0].id+'" name="'+s.tabs[0].name+'"></div>';s.selector.html(o),s.dlg=s.selector.dialog({autoOpen:!1,dialogClass:"noTitleBar",closeOnEscape:!0,draggable:!0,width:500,minHeight:300,height:500,modal:!0,resizable:!0,title:e,close:function(t,e){s.selector.empty()}}),s.tabs.length>1?(t("div[name='filedialogTabs']",s.selector).tabs({heightStyle:"content"}),t.each(this.tabs,function(t,e){"filebrowser"===e.name||"uploader"===e.name&&a(e)})):a(s.tabs[0])},i.prototype.configure=function(t){this.tabs=void 0===t.tabs?[]:t.tabs,this.message=t.message,this.tags=t.tags,this.uploadURI=t.uploadURI,this.onUploadComplete=t.onUploadComplete,this.willGenerateThumbnails=void 0!==t.willGenerateThumbnails&&null!==t.willGenerateThumbnails&&t.willGenerateThumbnails},i.prototype.setDimensions=function(){var e=this.selector.height(),i=this.selector.width(),o=t("div[class='gadgetui-filedialog-dropzone']",this.selector),s=t("div[class='gadgetui-filedialog-filedisplay']",this.selector),a=t("div[class~='buttons']",this.selector);t.each(this.tabs,function(i,o){t("#"+o.id).css("height",e-75)}),o.css("height",e-a.height()-100).css("width",i),s.css("height",e-a.height()-100).css("width",i)},i.prototype.setEventHandlers=function(){var e=this;t.each(this.tabs,function(i,o){!function(i){switch(i.name){case"uploader":t("input[name='fileselect']",e.selector).on("change",function(o){var s=t("div[name='dropzone']",e.selector),a=t("div[name='filedisplay']",e.selector);e.processUpload(o,o.target.files,s,a,i)})}}(o)}),t("input[name='close']",this.selector).on("click",function(){e.close()})},i.prototype.renderDropZone=function(e){var i=t("div[name='dropzone']",this.selector),o=t("div[name='filedisplay']",this.selector),s=this;i.off("dragover").off("drop").off("dragenter").off("dragleave").on("dragenter",function(t){i.addClass("highlighted"),t.preventDefault(),t.stopPropagation()}).on("dragleave",function(t){t.stopPropagation(),t.preventDefault(),i.removeClass("highlighted")}).on("dragover",function(t){s.handleDragOver(t)}).on("drop",function(t){t.stopPropagation(),t.preventDefault(),s.processUpload(t,t.originalEvent.dataTransfer.files,i,o,e)})},i.prototype.processUpload=function(e,i,o,s,a){var r,n=this;n.uploadingFiles=[],t.each(i,function(t,e){r=gadgetui.objects.Constructor(gadgetui.display.FileUploadWrapper,[e,s],!0),n.uploadingFiles.push(r),r.on("uploadComplete",function(t){var e;for(e=0;e<n.uploadingFiles.length;e++)n.uploadingFiles[e].id===t.id&&n.uploadingFiles.splice(e,1);0===n.uploadingFiles.length&&(n.show("dropzone"),n.setDimensions())})}),o.removeClass("highlighted"),o.hide(),s.css("display","table-cell"),n.handleFileSelect(n.uploadingFiles,e)},i.prototype.handleFileSelect=function(t,e){e.stopPropagation(),e.preventDefault();this.willGenerateThumbnails?this.generateThumbnails(t):this.upload(t)},i.prototype.generateThumbnails=function(e){var i=this;t.each(e,function(o,s){switch(s.file.type){case"application/pdf":!function(o,s){var a=URL.createObjectURL(o.file);o.progressbar.update(" - generating thumbnail"),PDFJS.getDocument(a).then(function(a){a.getPage(1).then(function(a){var r,n=a.getViewport(.5),l=document.createElement("canvas"),d=l.getContext("2d");l.height=n.height,l.width=n.width,r={canvasContext:d,viewport:n},a.render(r).then(function(){d.globalCompositeOperation="destination-over",d.fillStyle="#ffffff",d.fillRect(0,0,l.width,l.height);var a=l.toDataURL();o=t.extend(o,{tile:a}),s===e.length-1&&i.upload(e)})})})}(s,o);break;case"image/jpg":case"image/jpeg":case"image/png":case"image/gif":!function(o,s){try{o.progressbar.update(" - generating thumbnail"),t.canvasResize(o.file,{width:200,height:0,crop:!1,quality:80,callback:function(a,r,n){o=t.extend(o,{tile:a}),s===e.length-1&&i.upload(e)}})}catch(t){}}(s,o);break;default:s.progressbar.update("Could not generate thumbnail on client"),s=t.extend(s,{tile:""}),o===e.length-1&&i.upload(e)}})},i.prototype.upload=function(e){t.each(e,function(t,e){e.progressbar.start()}),this.uploadFile(e)},i.prototype.uploadFile=function(t){var e=this;!function(){var i,o,s,a,r,n,l,d,h=[];for(d=0;d<t.length;d++){for(h=[],o=1048576,s=(i=t[d].file).size,a=Math.ceil(s/o),r=0,n=o;r<s;)l=i.hasOwnProperty("mozSlice")?i.mozSlice(r,n):i.hasOwnProperty("webkitSlice")?i.webkitSlice(r,n):i.slice(r,n),h.push(l),n=(r=n)+o;e.uploadChunk(t[d],h,1,a)}}()},i.prototype.uploadChunk=function(e,i,o,s){var a,r=new XMLHttpRequest,n=this,l=void 0===n.tags?"":n.tags;"image"===e.file.type.substr(0,5)&&(l="image "+l),r.onreadystatechange=function(){var l;if(4===r.readyState)if(a=r.response,o<=s&&e.progressbar.updatePercent(parseInt(o/s*100,10)),o<s)e.id=r.getResponseHeader("X-Id"),o++,n.uploadChunk(e,i,o,s);else{try{l={data:t.parseJSON(a)}}catch(t){l={}}n.handleUploadResponse(l,e)}},r.open("POST",n.uploadURI,!0),1===o&&r.setRequestHeader("X-Tags",l),r.setRequestHeader("X-Id",e.id),r.setRequestHeader("X-FileName",e.file.name),r.setRequestHeader("X-FileSize",e.file.size),r.setRequestHeader("X-FilePart",o),r.setRequestHeader("X-Parts",s),r.setRequestHeader("X-MimeType",e.file.type||"application/octet-stream"),r.setRequestHeader("X-HasTile",void 0!==e.tile&&e.tile.length>0),r.setRequestHeader("Content-Type","application/octet-stream"),r.send(i[o-1])},i.prototype.handleUploadResponse=function(t,e){var i=gadgetui.objects.Constructor(gadgetui.objects.FileItem,[{mimetype:t.data.mimetype,fileid:t.data.fileId,filename:t.data.filename,filesize:t.data.filesize,tags:t.data.tags,created:t.data.created,createdStr:t.data.created,disabled:t.data.disabled,path:t.data.path}],!1);e.completeUpload(i),void 0!==this.onUploadComplete&&this.onUploadComplete(i)},i.prototype.show=function(e){var i=t("div[class='gadgetui-filedialog-dropzone']",this.selector),o=t("div[class='gadgetui-filedialog-filedisplay']",this.selector);"dropzone"===e?(i.css("display","table-cell"),o.css("display","none")):(o.css("display","table-cell"),i.css("display","none"))},i.prototype.handleDragOver=function(t){t.stopPropagation(),t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy"},i.prototype.close=function(){this.dlg.dialog("close")},o.prototype.addBindings=function(){var e=this;t(this.selector).parent().on("click",function(){t(e).focus()}).on("click","div[class~='gadgetui-lookuplist-input-cancel']",function(i){e.remove(e.selector,t(i.target).attr("gadgetui-lookuplist-input-value"))}),t(this.selector).autocomplete({minLength:e.minLength,source:function(i,o){o(t.ui.autocomplete.filter(e.datasource,gadgetui.util.extractLast(i.term)))},focus:function(){return!1},select:function(t,i){return gadgetui.util.split(this.value).pop(),e.add(e.selector,i.item),this.value="",this.focus(),!1}}).on("keydown",function(e){(t(this).css("width",Math.round(.66*t(this).val().length+3)+"em"),e.keyCode===t.ui.keyCode.TAB&&t(this).data("ui-autocomplete").menu.active&&e.preventDefault(),e.keyCode===t.ui.keyCode.BACKSPACE&&0===t(this).val().length)&&(e.preventDefault(),t(this).prev("div[class~='gadgetui-lookuplist-input-item-wrapper']").remove())}),t.ui.autocomplete.prototype._renderItem=function(i,o){return"function"==typeof e.menuItemRenderer?t("<li>").attr("data-value",o.value).append(t("<a>").text(e.menuItemRenderer(o))).appendTo(i):t("<li>").append(t("<a>").text(o.label)).appendTo(i)}},o.prototype.add=function(e,i){var o,s;t("<div class='gadgetui-lookuplist-input-item-wrapper'><div class='gadgetui-lookuplist-input-cancel ui-corner-all ui-widget-content' gadgetui-lookuplist-input-value='"+i.value+"'><div class='gadgetui-lookuplist-input-item'>"+this.itemRenderer(i)+"</div></div></div>").insertBefore(e),t(e).val(""),void 0!==i.title&&t("div[class~='gadgetui-lookuplist-input-cancel']",t(e).parent()).last().attr("title",i.title),!0===this.emitEvents&&t(e).trigger("gadgetui-lookuplist-input-add",[i]),void 0!==this.func&&this.func(i,"add"),void 0!==this.model&&(o=t(e).attr("gadgetui-bind"),s=this.model.get(o),!1===t.isArray(s)&&(s=[]),s.push(i),this.model.set(o,s))},o.prototype.remove=function(e,i){t("div[gadgetui-lookuplist-input-value='"+i+"']",t(e).parent()).parent().remove();var o,s,a=this;void 0!==this.model&&(o=t(e).attr("gadgetui-bind"),s=this.model.get(o),t.each(s,function(r,n){if(n.value===i)return s.splice(r,1),void 0!==a.func&&a.func(n,"remove"),!0===a.emitEvents&&t(e).trigger("gadgetui-lookuplist-input-remove",[n]),a.model.set(o,s),!1}))},o.prototype.reset=function(){t(".gadgetui-lookuplist-input-item-wrapper",t(this.el).parent()).empty(),void 0!==this.model&&(prop=t(this.el).attr("gadget-ui-bind"),list=this.model.get(prop),list.length=0)},o.prototype.config=function(e){return void 0!==t(this.selector).attr("gadgetui-bind")&&(this.model=void 0===e.model?gadgetui.model:e.model),this.func=void 0===e.func?void 0:e.func,this.itemRenderer=void 0===e.itemRenderer?this.itemRenderer:e.itemRenderer,this.menuItemRenderer=void 0===e.menuItemRenderer?this.menuItemRenderer:e.menuItemRenderer,this.emitEvents=void 0===e.emitEvents||e.emitEvents,this.datasource=void 0===e.datasource?void 0===e.lookupList||e.lookupList:e.datasource,this.width=void 0===e.width?void 0:e.width,this.minLength=void 0===e.minLength?0:e.minLength,this},s.prototype.setInitialValue=function(){this.selector.val(this.value.id)},s.prototype.addControl=function(){t(this.selector).wrap("<div class='gadgetui-selectinput-div'></div>"),t(this.selector).parent().prepend("<div class='gadgetui-selectinput-label'>"+this.value.text+"</div>"),this.label=t("div[class='gadgetui-selectinput-label']",t(this.selector).parent()),this.label.attr("gadgetui-bind",this.selector.attr("gadgetui-bind"))},s.prototype.addCSS=function(){var e,i,o=gadgetui.util.getStyle(t(this.selector));this.selector.css("min-width","100px"),this.selector.css("font-size",o.fontSize),i=gadgetui.util.getStyle(t(this.selector).parent()),e=gadgetui.util.getNumberValue(i.height)-2,this.label.attr("style",""),this.label.css("padding-top","2px"),this.label.css("height",e+"px"),this.label.css("margin-left","9px"),navigator.userAgent.match(/Edge/)?this.selector.css("margin-left","5px"):navigator.userAgent.match(/MSIE/)&&(this.selector.css("margin-top","0px"),this.selector.css("margin-left","5px"))},s.prototype.addBindings=function(){var t=this;this.label.on(this.activate,function(e){t.label.css("display","none"),t.selector.css("display","inline-block"),e.preventDefault()}),this.selector.on("blur",function(e){t.label.css("display","inline-block"),t.selector.css("display","none")}),this.selector.on("change",function(e){setTimeout(function(){var i=e.target.value,o=e.target[e.target.selectedIndex].innerHTML;0===i.trim().length&&(i=0),t.label.text(o),void 0!==t.model&&void 0===t.selector.attr("gadgetui-bind")&&t.model.set(this.name,{id:i,text:o}),!0===t.emitEvents&&gadgetui.util.trigger(t.selector,"gadgetui-input-change",{id:i,text:o}),void 0!==t.func&&t.func({id:i,text:o}),t.value={id:i,text:o}},100)}),this.selector.on("mouseleave",function(){t.selector!==document.activeElement&&(t.label.css("display","inline-block"),t.selector.css("display","none"))})},s.prototype.config=function(e){e=void 0===e?{}:e,this.model=void 0===e.model?void 0:e.model,this.func=void 0===e.func?void 0:e.func,this.emitEvents=void 0===e.emitEvents||e.emitEvents,this.activate=void 0===e.activate?"mouseenter":e.activate,this.value=void 0===e.value?{id:t(this.selector).val(),text:t(this.selector)[0][t(this.selector)[0].selectedIndex].innerHTML}:e.value},a.prototype.addControl=function(){this.selector.wrap("<div class='gadgetui-inputdiv'></div>"),this.inputDiv=this.selector.parent(),this.inputDiv.wrap("<div class='gadgetui-textinput-div'></div>"),this.wrapper=this.selector.parent().parent(),this.wrapper.prepend("<div class='gadgetui-inputlabel'><input type='text' data-active='false' class='gadgetui-inputlabelinput' readonly='true' style='border:0;background:none;' value='"+this.value+"'></div>"),this.labelDiv=t("div[class='gadgetui-inputlabel']",this.wrapper),this.label=t("input[class='gadgetui-inputlabelinput']",this.wrapper),this.label.attr("gadgetui-bind",this.selector.attr("gadgetui-bind"))},a.prototype.setInitialValue=function(){var t=this.selector.val(),e=this.selector.attr("placeholder");0===t.length&&(t=null!==e&&void 0!==e&&e.length>0?e:" ... "),this.value=t},a.prototype.setLineHeight=function(){var t=this.selector.outerHeight();this.lineHeight=t},a.prototype.setFont=function(){var t=gadgetui.util.getStyle(this.selector),e=t.fontFamily+" "+t.fontSize+" "+t.fontWeight+" "+t.fontVariant;this.font=e},a.prototype.setWidth=function(){this.width=t.gadgetui.textWidth(this.selector.val(),this.font)+10,10===this.width&&(this.width=this.maxWidth)},a.prototype.setMaxWidth=function(){var t=gadgetui.util.getStyle(this.selector.parent().parent());this.maxWidth=gadgetui.util.getNumberValue(t.width)},a.prototype.addCSS=function(){var e=gadgetui.util.getStyle(this.selector);this.selector.addClass("gadgetui-textinput"),this.label.css("background","none").css("padding-left","4px").css("border"," 1px solid transparent").css("width",this.width).css("font-family",e.fontFamily).css("font-size",e.fontSize).css("font-weight",e.fontWeight).css("font-variant",e.fontVariant).css("max-width","").css("min-width",this.minWidth),this.lineHeight>20&&(this.wrapper.css("min-height",this.lineHeight),this.labelDiv.css("min-height",this.lineHeight),this.inputDiv.css("min-height",this.lineHeight)),this.labelDiv.css("height",this.lineHeight).css("font-size",e.fontSize).css("display","block"),this.inputDiv.css("height",this.lineHeight).css("font-size",e.fontSize).css("display","block"),this.selector.css("padding-left","4px").css("border","1px solid "+this.borderColor).css("font-family",e.fontFamily).css("font-size",e.fontSize).css("font-weight",e.fontWeight).css("font-variant",e.fontVariant).css("width",this.width).css("min-width",this.minWidth),this.selector.attr("placeholder",this.value),this.inputDiv.css("display","none"),this.maxWidth>10&&!0===this.enforceMaxWidth&&(this.label.css("max-width",this.maxWidth),this.selector.css("max-width",this.maxWidth),this.maxWidth<this.width&&this.label.val(t.gadgetui.fitText(this.value,this.font,this.maxWidth)))},a.prototype.setControlWidth=function(e){var i=parseInt(t.gadgetui.textWidth(e,this.font),10);i<this.minWidth&&(i=this.minWidth),this.selector.css("width",i+30),this.label.css("width",i+30)},a.prototype.addBindings=function(){var e=this;this.label.on(e.activate,function(t){!e.useActive||"false"!==e.label.attr("data-active")&&void 0!==e.label.attr("data-active")?setTimeout(function(){gadgetui.util.setStyle;e.labelDiv.css("display","none"),e.inputDiv.css("display","block"),e.setControlWidth(e.selector.val()),"click"===e.activate&&e.selector.focus(),!0===e.emitEvents&&e.selector.trigger("gadgetui-input-show",e.selector)},e.delay):e.label.attr("data-active","true")}),this.selector.on("focus",function(t){t.preventDefault()}),this.selector.on("keyup",function(t){13===parseInt(t.keyCode,10)&&this.blur(),e.setControlWidth(this.value)}),this.selector.on("change",function(i){setTimeout(function(){var o,s=i.target.value;0===s.length&&void 0!==e.selector.attr("placeholder")&&(s=e.selector.attr("placeholder")),o=t.gadgetui.textWidth(s,e.font),e.maxWidth<o&&(s=t.gadgetui.fitText(s,e.font,e.maxWidth)),e.label.val(s),void 0!==e.model&&void 0===e.selector.attr("gadgetui-bind")&&e.model.set(e.selector.name,i.target.value),!0===e.emitEvents&&e.selector.trigger("gadgetui-input-change",{text:i.target.value}),void 0!==e.func&&e.func({text:i.target.value})},200)}),this.selector.on("mouseleave",function(){this!==document.activeElement&&(e.labelDiv.css("display","block"),e.inputDiv.css("display","none"),e.label.css("maxWidth",e.maxWidth))}),this.selector.on("blur",function(){e.inputDiv.css("display","none"),e.labelDiv.css("display","block"),e.label.attr("data-active","false"),e.selector.css("maxWidth",e.maxWidth),e.label.css("maxWidth",e.maxWidth)})},a.prototype.config=function(t){t=void 0===t?{}:t,this.borderColor=void 0===t.borderColor?"#d0d0d0":t.borderColor,this.useActive=void 0!==t.useActive&&t.useActive,this.model=void 0===t.model?this.model:t.model,this.func=void 0===t.func?void 0:t.func,this.emitEvents=void 0===t.emitEvents||t.emitEvents,this.activate=void 0===t.activate?"mouseenter":t.activate,this.delay=void 0===t.delay?10:t.delay,this.enforceMaxWidth=void 0!==t.enforceMaxWidth&&t.enforceMaxWidth},{ComboBox:e,FileUploader:i,TextInput:a,SelectInput:s,LookupListInput:o}}(jQuery),gadgetui.objects=function(){var t={on:function(t,e){return void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e),this},off:function(t){return this.events[t]=[],this},fireEvent:function(t,e){var i=this;void 0!==this.events[t]&&this.events[t].forEach(function(t){t(i,e)})},getAll:function(){return[{name:"on",func:this.on},{name:"off",func:this.off},{name:"fireEvent",func:this.fireEvent}]}};function e(t){this.set(t)}return e.prototype.set=function(t){this.fileid=void 0!==t.fileid?t.fileid:"",this.filename=void 0!==t.filename?t.filename:"",void 0!==t.filename?(this.filenameabbr=t.filename.substr(0,25),t.filename.length>25&&(this.filenameabbr=this.filenameabbr+"...")):this.filenameabbr="",this.filesize=void 0!==t.filesize?t.filesize:"",this.tags=void 0!==t.tags?t.tags:"",this.path=void 0!==t.path?t.path:"",this.created=void 0!==t.created?t.created:"",this.createdStr=void 0!==t.created?t.createdStr:"",this.disabled=void 0!==t.disabled?t.disabled:0,this.mimetype=void 0!==t.mimetype?t.mimetype:"application/x-unknown",this.tile=void 0!==t.tile?t.tile:""},{Constructor:function(e,i,o){var s,a,r,n;if(!0===o)for(n=t.getAll(),s=0;s<n.length;s++)void 0===e.prototype[n[s].name]&&(e.prototype[n[s].name]=n[s].func);if(r=Object.create(e.prototype),void 0===(a=e.apply(r,i))&&(a=r),!0===o)for(a.events={},s=0;s<e.prototype.events.length;s++)a.events[e.prototype.events[s]]=[];return a},EventBindings:t,FileItem:e}}(),gadgetui.util={split:function(t){return t.split(/,\s*/)},extractLast:function(t){return this.split(t).pop()},getNumberValue:function(t){return Number(t.substring(0,t.length-2))},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=" "+e},removeClass:function(t,e){if(t.classList)t.classList.remove(e);else{var i=t.className;i.replace(/ + className + /gi,""),t.className=i}},getOffset:function(t){var e=t.getBoundingClientRect();return{top:e.top+document.body.scrollTop,left:e.left+document.body.scrollLeft}},getRelativeParentOffset:function(t){var e,i=t.parentsUntil("body"),o=0,s=0;for(e=0;e<i.length;e++)if("relative"===i[e].style.position){var a=gadgetui.util.getOffset(i[e]);a.left>o&&(o=a.left),a.top>s&&(s=a.top)}return{left:o,top:s}},Id:function(){return(100*Math.random()).toString().replace(/\./g,"")},bind:function(t,e){var i=t[0].getAttribute("gadgetui-bind");void 0!==i&&void 0!==e&&e.bind(i,t)},encode:function(t,e){var i,o=!0,s=!0,a="html";if(void 0!==e&&(o=void 0===e.canon||e.canon,s=void 0===e.encode||e.encode,a=void 0===e.encodeType?"html":e.encodeType),o&&(i=$.encoder.canonicalize(t)),s)switch(a){case"html":i=$.encoder.encodeForHTML(i);break;case"css":i=$.encoder.encodeForCSS(i);break;case"attr":i=$.encoder.encodeForHTMLAttribute(i);break;case"js":i=$.encoder.encodeForJavascript(i);break;case"url":i=$.encoder.encodeForURL(i)}return i},mouseCoords:function(t){return t.pageX||t.pageY?{x:t.pageX,y:t.pageY}:{x:t.clientX+document.body.scrollLeft-document.body.clientLeft,y:t.clientY+document.body.scrollTop-document.body.clientTop}},mouseWithin:function(t,e){var i=t[0].getBoundingClientRect();return e.x>=i.left&&e.x<=i.right&&e.y>=i.top&&e.y<=i.bottom},getStyle:function(t,e){return void 0!==window.getComputedStyle?void 0!==e?window.getComputedStyle(t[0],null).getPropertyValue(e):window.getComputedStyle(t[0],null):void 0!==e?t[0].currentStyle[e]:t[0].currentStyle},textWidth:function(t,e){gadgetui.util.textWidthEl||(gadgetui.util.textWidthEl=document.createElement("div"),gadgetui.util.textWidthEl.setAttribute("id","gadgetui-textWidth"),gadgetui.util.textWidthEl.setAttribute("style","display: none;"),document.body.appendChild(gadgetui.util.textWidthEl));var i,o=t;return o.length>0&&(gadgetui.util.textWidthEl.innerText=o,o=void 0===o?"":o.replace(/\s/g,"&nbsp;")),gadgetui.util.textWidthEl.innertText=o,gadgetui.util.textWidthEl.style.fontFamily=e.fontFamily,gadgetui.util.textWidthEl.style.fontSize=e.fontSize,gadgetui.util.textWidthEl.style.fontWeight=e.fontWeight,gadgetui.util.textWidthEl.style.fontVariant=e.fontVariant,gadgetui.util.textWidthEl.style.display="inline",i=gadgetui.util.textWidthEl.offsetWidth,gadgetui.util.textWidthEl.style.display="none",i}};