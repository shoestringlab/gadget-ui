"use strict";var gadgetui={keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}};class Component{constructor(){this.events={}}on(e,t){return void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this}off(e){return this.events[e]=[],this}fireEvent(e,t){void 0!==this.events[e]&&this.events[e].forEach(e=>{e(this,t)})}getAll(){return[{name:"on",func:this.on},{name:"off",func:this.off},{name:"fireEvent",func:this.fireEvent}]}}gadgetui.model=(()=>{const e=new Map,t=new Map;let i=20;class s{constructor(e,t){this.data=this.processValue(e),this.elements=[],this.mementos=[],this.currentMementoIndex=-1,t&&this.bind(t),this.saveMemento()}handleEvent(e){if("change"===e.type){e.originalSource??="BindableObject.handleEvent[change]";for(const{elem:t,prop:i}of this.elements)if(e.target.name===i&&"BindableObject.updateDomElement"!==e.originalSource){const t=e.target.type.includes("select")?{id:e.target.value,text:e.target.options[e.target.selectedIndex].textContent}:e.target.value;this.change(t,e,i)}}}change(e,t,i){t.originalSource??="BindableObject.change",console.log(`change : Source: ${t.originalSource}`);const s=this.processValue(e);if(i){if("object"!=typeof this.data||null===this.data)throw new Error("Attempt to treat a simple value as an object with properties.");if(!(i in this.data))throw new Error(`Property '${i}' of object is undefined.`);this.data[i]=s}else this.data=s;this.saveMemento(),this.elements.filter(({prop:e,elem:s})=>(!i||i===e)&&s!==t.target).forEach(({elem:e})=>this.updateDomElement(t,e,s))}updateDom(e,t,i){e.originalSource??="BindableObject.updateDom",this.elements.forEach(({elem:s,prop:n})=>{i?n===i&&this.updateDomElement(e,s,t):"object"==typeof t&&null!==t?n in t&&this.updateDomElement(e,s,t[n]):this.updateDomElement(e,s,t)})}updateDomElement(e,t,i){e.originalSource??="BindableObject.updateDomElement";const s=()=>{t.innerHTML="";const e=Array.isArray(i)?i:i instanceof Map?Array.from(i.entries()):[i];"SELECT"===t.tagName?e.forEach((e,i)=>{const s=document.createElement("option");s.value="object"==typeof e?e.id??e[0]:e,s.textContent="object"==typeof e?e.text??e[1]:e,t.appendChild(s)}):["UL","OL"].includes(t.tagName)&&e.forEach(e=>{const i=document.createElement("li");i.textContent="object"==typeof e?e.text??e[1]:e,t.appendChild(i)})},n=["INPUT","TEXTAREA"].includes(t.tagName),a=["OL","UL","SELECT"].includes(t.tagName),o=["DIV","SPAN","H1","H2","H3","H4","H5","H6","P","LABEL","BUTTON","A","STRONG","EM","B","I","U","SMALL","SUB","SUP","Q","BLOCKQUOTE","CITE","CODE","PRE","ABBR","DFN","SAMP","KBD","VAR","LI","DT","DD","TH","TD","CAPTION","FIGCAPTION","SUMMARY","LEGEND","TITLE"].includes(t.tagName);"object"==typeof i&&null!==i?n?t.value=i.id??(i instanceof Map?"":i[0])??"":a?s():o&&(t.textContent=i.text??(i instanceof Map?"":i[1])??""):n?t.value=i??"":a?s():o&&(t.textContent=i??""),"model.set"!==e.originalSource&&"memento.restore"!==e.originalSource&&t.dispatchEvent(new Event("change",{originalSource:"model.updateDomElement"}))}bind(e,t){const i={elem:e,prop:t||""};e.value=t?this.data[t]:this.data,e.addEventListener("change",this),this.elements.push(i)}processValue(e){switch(typeof e){case"undefined":case"number":case"boolean":case"function":case"symbol":case"string":default:return e;case"object":return null===e?null:e instanceof Map?new Map(e):JSON.parse(JSON.stringify(e))}}saveMemento(){this.currentMementoIndex<this.mementos.length-1&&this.mementos.splice(this.currentMementoIndex+1);const e=this.processValue(this.data);this.mementos.push(e),this.mementos.length>i?this.mementos.shift():this.currentMementoIndex++}undo(){return this.currentMementoIndex>0&&(this.currentMementoIndex--,this.restoreMemento(),!0)}redo(){return this.currentMementoIndex<this.mementos.length-1&&(this.currentMementoIndex++,this.restoreMemento(),!0)}rewind(){return this.currentMementoIndex>0&&(this.currentMementoIndex=0,this.restoreMemento(),!0)}fastForward(){return this.currentMementoIndex<this.mementos.length-1&&(this.currentMementoIndex=this.mementos.length-1,this.restoreMemento(),!0)}restoreMemento(){this.data=this.processValue(this.mementos[this.currentMementoIndex]);const e={originalSource:"memento.restore"};this.elements.forEach(({elem:t,prop:i})=>{this.updateDomElement(e,t,i?this.data[i]:this.data)})}}return{BindableObject:s,init(e={}){i=e.maxMementos??20},create(i,n,a){const o=new s(n).processValue(n),r=new s(o,a);e.set(i,r),t.set(i,r)},destroy(i){e.delete(i),t.delete(i)},bind(t,i){const[s,n]=t.split("."),a=e.get(s);a&&a.bind(i,n)},exists:t=>e.has(t),get(t){if(!t)return void console.log("Expected parameter [name] is not defined.");const[i,s]=t.split("."),n=e.get(i);if(!n)return void console.log(`Key '${i}' does not exist in the model.`);const a=s?n.data[s]:n.data;return a instanceof Map?new Map(a):a},set(t,i){if(!t)return void console.log("Expected parameter [name] is not defined.");const[s,n]=t.split("."),a={originalSource:"model.set"};if(e.has(s)){const t=e.get(s),o=t.processValue(i);t.change(o,a,n),t.updateDom(a,o,n)}else{if(n)throw new Error(`Object ${s} is not yet initialized.`);this.create(s,i)}},undo(e){const i=t.get(e);return!!i&&i.undo()},redo(e){const i=t.get(e);return!!i&&i.redo()},rewind(e){const i=t.get(e);return!!i&&i.rewind()},fastForward(e){const i=t.get(e);return!!i&&i.fastForward()}}})(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var i,s,n,a,o=Object(this),r=o.length>>>0;if("function"!=typeof e)throw new TypeError;for(i=t||void 0,s=0;s<r;)n=s.toString(),o.hasOwnProperty(n)&&(a=o[n],e.call(i,a,s,o)),s+=1}),gadgetui.display=function(){function e(e,t,i=""){const s=gadgetui.util.Id(),n={id:s,key:i,filename:e.name,width:gadgetui.util.getStyle(t,"width")},a=gadgetui.objects.EventBindings.getAll();this.file=e,this.id=s,this.key=i,this.progressbar=new gadgetui.display.ProgressBar(t,n),this.progressbar.render(),a.forEach(e=>{this[e.name]=e.func})}e.prototype.events=["uploadComplete","uploadAborted"],e.prototype.completeUpload=function(e){setTimeout(()=>{this.progressbar.destroy(),this.fireEvent("uploadComplete",e)},1e3)},e.prototype.abortUpload=function(e){setTimeout(()=>{this.progressbar.destroy(),this.fireEvent("uploadAborted",e)},1e3)};class t extends Component{constructor(e,t){super(),this.element=e,this.config(t||{}),this.setup(t)}setup(e){this.setMessage(),this.addControl(),this.addHeader(),this.enableShrink&&(this.maxmin=this.wrapper.querySelector("div.oi[name='maxmin']"));const t=2*parseInt(gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.element,"padding")),10),i=gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.header,"height"))+6;this.minWidth=this.title.length>0?gadgetui.util.textWidth(this.title,this.header.style)+80:100,gadgetui.util.setStyle(this.element,"width",this.width-t),this.height=e?.height??gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.element,"height"))+t+i+10,this.addCSS(),this.height=gadgetui.util.getStyle(this.wrapper,"height"),this.relativeOffsetLeft=gadgetui.util.getRelativeParentOffset(this.element).left,this.addBindings()}setMessage(){this.message&&(this.element.innerText=this.message)}addBindings(){gadgetui.util.draggable(this.wrapper);this.wrapper.addEventListener("drag_end",e=>{this.top=e.detail.top,this.left=e.detail.left,this.relativeOffsetLeft=gadgetui.util.getRelativeParentOffset(this.element).left,this.fireEvent("moved")}),this.enableShrink&&this.shrinker.addEventListener("click",e=>{e.stopPropagation(),this.minimized?this.expand():this.minimize()}),this.enableClose&&this.closer.addEventListener("click",e=>{e.stopPropagation(),this.close()})}close(){this.fireEvent("closed"),this.wrapper.parentNode.removeChild(this.wrapper)}addHeader(){const e=gadgetui.util.setStyle;if(this.header=document.createElement("div"),this.header.innerHTML=this.title,this.header.classList.add(this.headerClass||"gadget-ui-floatingPane-header"),this.enableShrink){this.shrinker=document.createElement("span"),this.shrinker.setAttribute("name","maxmin"),e(this.shrinker,"position","absolute"),e(this.shrinker,"right","20px"),e(this.shrinker,"margin-right",".5em");const t="img"===this.iconType?`<img class="${this.iconClass}" src="${this.minimizeIcon}"/>`:`<svg class="${this.iconClass}"><use xlink:href="${this.minimizeIcon}"/></svg>`;this.shrinker.innerHTML=t,this.header.appendChild(this.shrinker)}if(this.wrapper.insertBefore(this.header,this.element),this.enableClose){const e=document.createElement("span");e.setAttribute("name","closeIcon");const t="img"===this.iconType?`<img class="${this.iconClass}" src="${this.closeIcon}"/>`:`<svg class="${this.iconClass}"><use xlink:href="${this.closeIcon}"/></svg>`;e.innerHTML=t,this.header.appendChild(e),Object.assign(e.style,{right:"3px",position:"absolute",cursor:"pointer",top:"3px"}),this.closer=e}}addCSS(){const e=gadgetui.util.setStyle,t={width:this.width,"z-index":this.zIndex,...this.backgroundColor&&{"background-color":this.backgroundColor},...void 0!==this.top&&{top:this.top},...void 0!==this.left&&{left:this.left},...void 0!==this.bottom&&{bottom:this.bottom},...void 0!==this.right&&{right:this.right}};Object.entries(t).forEach(([t,i])=>e(this.wrapper,t,i))}addControl(){const e=document.createElement("div");e.classList.add(this.class||"gadget-ui-floatingPane"),e.draggable=!0,this.element.parentNode.insertBefore(e,this.element),this.wrapper=this.element.previousSibling,this.element.parentNode.removeChild(this.element),e.appendChild(this.element)}expand(){const e=gadgetui.util.setStyle,t=(gadgetui.util.getOffset(this.wrapper),parseInt(gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.wrapper.parentElement,"padding-left")),10),"img"===this.iconType?`<img class="${this.iconClass}" src="${this.minimizeIcon}"/>`:`<svg class="${this.iconClass}"><use xlink:href="${this.minimizeIcon}"/></svg>`);"undefined"!=typeof Velocity&&this.animate?(Velocity(this.wrapper,{width:this.width},{queue:!1,duration:500}),Velocity(this.element,{height:this.height},{queue:!1,duration:500,complete:()=>{this.shrinker.innerHTML=t,e(this.element,"overflow","scroll"),this.fireEvent("maximized")}})):(e(this.wrapper,"width",this.width),e(this.element,"height",this.height),this.shrinker.innerHTML=t,e(this.element,"overflow","scroll"),this.fireEvent("maximized")),this.minimized=!1}minimize(){const e=gadgetui.util.setStyle,t="img"===this.iconType?`<img class="${this.iconClass}" src="${this.maximizeIcon}"/>`:`<svg class="${this.iconClass}"><use xlink:href="${this.maximizeIcon}"/></svg>`;e(this.element,"overflow","hidden"),"undefined"!=typeof Velocity&&this.animate?(Velocity(this.wrapper,{width:this.minWidth},{queue:!1,duration:this.delay,complete:()=>this.shrinker.innerHTML=t}),Velocity(this.element,{height:"50px"},{queue:!1,duration:this.delay,complete:()=>{this.fireEvent("minimized")}})):(e(this.wrapper,"width",this.minWidth),e(this.element,"height","50px"),this.shrinker.innerHTML=t,this.fireEvent("minimized")),this.minimized=!0}config(e){this.message=e.message,this.animate=e.animate??!0,this.delay=e.delay??500,this.title=e.title||"",this.backgroundColor=e.backgroundColor||"",this.zIndex=e.zIndex??gadgetui.util.getMaxZIndex()+1,this.width=gadgetui.util.getStyle(this.element,"width"),this.top=e.top,this.left=e.left,this.bottom=e.bottom,this.right=e.right,this.class=e.class||!1,this.headerClass=e.headerClass||!1,this.minimized=!1,this.relativeOffsetLeft=0,this.enableShrink=e.enableShrink??!0,this.enableClose=e.enableClose??!0,this.iconClass=e.iconClass||"feather",this.iconType=e.iconType||"img",this.closeIcon=e.closeIcon||"/node_modules/feather-icons/dist/icons/x-circle.svg",this.minimizeIcon=e.minimizeIcon||"/node_modules/feather-icons/dist/icons/minimize.svg",this.maximizeIcon=e.maximizeIcon||"/node_modules/feather-icons/dist/icons/maximize.svg"}}return{Bubble:class extends Component{constructor(e={}){super(),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.configure(e),this.bubble={x:0,y:0,width:0,height:0,arrowPosition:"topleft",arrowAngle:315,text:"",padding:10,fontSize:this.fontSize,fontStyle:this.fontStyle,fontWeight:this.fontWeight,fontVariant:this.fontVariant,font:this.font,color:this.color,borderWidth:this.borderWidth,borderColor:this.borderColor,backgroundColor:this.backgroundColor,justifyText:this.justifyText,lineHeight:this.lineHeight,align:this.align,vAlign:this.vAlign}}configure(e={}){this.color=e.color??"#000",this.borderWidth=e.borderWidth??1,this.borderColor=e.borderColor??"#000",this.backgroundColor=e.backgroundColor??"#f0f0f0",this.fontSize=e.fontSize??14,this.font=e.font??"Arial",this.fontStyle=e.fontStyle??"",this.fontWeight=e.fontWeight??100,this.fontVariant=e.fontVariant??"",this.lineHeight=e.lineHeight??null,this.align=e.align??"center",this.vAlign=e.vAlign??"middle",this.justifyText=e.justifyText??!1}setBubble(e,t,i,s,n,a,o){this.bubble.x=e,this.bubble.y=t,this.bubble.width=i,this.bubble.height=s,this.setArrow(n,a,o),this.calculateBoundingRect();const r=this.getBoundingClientRect();this.canvas.height=r.height,this.canvas.width=r.width,document.body.appendChild(this.canvas)}setText(e){this.bubble.text=e}setPosition(e,t){this.bubble.x=e,this.bubble.y=t}setArrow(e,t,i){this.setArrowLength(t),this.setArrowPosition(e),this.setArrowAngle(i),this.setArrowComponents(),this.setArrowVector()}setArrowPosition(e){this.bubble.arrowPosition=e;const{x:t,width:i,y:s,height:n}=this.bubble,a={top:[t+i/2,s],topright:[t+i,s],right:[t+i,s+n/2],bottomright:[t+i,s+n],bottom:[t+i/2,s+n],bottomleft:[t,s+n],left:[t,s+n/2],topleft:[t,s]};[this.bubble.arrowX,this.bubble.arrowY]=a[e]||[t,s]}setArrowAngle(e){this.bubble.arrowAngle=e;const t={top:[280,360,0,80,0],topright:[10,80,45],right:[10,170,90],bottomright:[100,170,180],bottom:[100,260,180],bottomleft:[190,260,225],left:[190,350,270],topleft:[280,360,0,80,315]}[this.bubble.arrowPosition]||[315];(3===t.length?e>=t[0]&&e<=t[1]:e>=t[0]&&e<=t[1]||e>=t[2]&&e<=t[3])||(console.error(`Angle must be within valid range for ${this.bubble.arrowPosition}`),this.bubble.arrowAngle=t[t.length-1])}setArrowLength(e){this.bubble.arrowLength=e}setArrowComponents(){const e=Math.abs(this.bubble.arrowAngle-90)*Math.PI/180;this.bubble.arrowDx=Math.round(this.bubble.arrowLength*Math.cos(e)),this.bubble.arrowDy=Math.round(this.bubble.arrowLength*Math.sin(e))}setArrowVector(){const{arrowX:e,arrowY:t,arrowDx:i,arrowDy:s,arrowAngle:n}=this.bubble;n>=0&&n<=90?(this.bubble.arrowEndX=e+i,this.bubble.arrowEndY=t-s):(this.bubble.arrowEndX=e+i,this.bubble.arrowEndY=t+s)}calculateBoundingRect(){const{borderWidth:e}=this.bubble,t=Math.floor(e/2);this.bubble.top=Math.min(this.bubble.y,this.bubble.arrowEndY)-t,this.bubble.left=Math.min(this.bubble.x,this.bubble.arrowEndX)-t,this.bubble.right=Math.max(this.bubble.x+this.bubble.width,this.bubble.arrowEndX)+t,this.bubble.bottom=Math.max(this.bubble.y+this.bubble.height,this.bubble.arrowEndY)+t}getBoundingClientRect(){return{top:this.bubble.top,left:this.bubble.left,bottom:this.bubble.bottom,right:this.bubble.right,height:this.bubble.bottom-this.bubble.top,width:this.bubble.right-this.bubble.left}}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=this.bubble.backgroundColor,this.ctx.strokeStyle=this.bubble.borderColor,this.ctx.lineWidth=this.bubble.borderWidth;const e=this.bubble.x,t=this.bubble.y;this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.lineTo(e,t+this.bubble.height),this.ctx.lineTo(e+this.bubble.width,t+this.bubble.height),this.ctx.lineTo(e+this.bubble.width,t),this.ctx.lineTo(e,t),this.ctx.closePath(),this.ctx.moveTo(this.bubble.arrowX,this.bubble.arrowY),this.ctx.lineTo(this.bubble.arrowEndX,this.bubble.arrowEndY),this.ctx.fill(),this.ctx.stroke(),this.ctx.fillStyle=this.bubble.color;const i={x:e+this.bubble.padding,y:t+this.bubble.padding,width:this.bubble.width-2*this.bubble.padding-2*this.bubble.borderWidth,height:this.bubble.height-2*this.bubble.padding-2*this.bubble.borderWidth,fontSize:this.bubble.fontSize,justify:this.bubble.justifyText,align:this.bubble.align,vAlign:this.bubble.vAlign,font:this.bubble.font,fontStyle:this.bubble.fontStyle,fontWeight:this.bubble.fontWeight,fontVariant:this.bubble.fontVariant,lineHeight:this.bubble.lineHeight};gadgetui.util.drawText(this.ctx,this.bubble.text,i)}attachToElement(e,t){if(!e)return;const i=e.getBoundingClientRect(),s=this.canvas.getBoundingClientRect(),n={top:[i.left+i.width/2,i.top],topright:[i.right,-this.bubble.padding],right:[i.right,i.top/2+i.height/2],bottomright:[i.right,i.bottom],bottom:[i.left+i.width/2,i.bottom],bottomleft:[i.left-s.width,i.bottom],left:[i.left-s.width,i.top-i.height/2],topleft:[i.left-s.width,i.top-s.height]},[a,o]=n[t]||[0,0];this.canvas.style.left=`${a}px`,this.canvas.style.top=`${o}px`,this.canvas.style.position="absolute"}destroy(){document.body.removeChild(this.canvas)}},CollapsiblePane:class extends Component{constructor(e,t={}){super(),this.element=e,this.config(t),this.addControl(),this.addCSS(),this.addHeader(),this.icon=this.wrapper.querySelector("div.oi"),this.addBindings(),this.height=this.wrapper.offsetHeight,this.headerHeight=this.header.offsetHeight,this.selectorHeight=this.element.offsetHeight,this.collapse&&this.toggle()}events=["minimized","maximized"];addControl(){const e=document.createElement("div");this.class&&e.classList.add(this.class),e.classList.add("gadget-ui-collapsiblePane"),this.element.parentNode.insertBefore(e,this.element),this.wrapper=this.element.previousSibling,this.element.parentNode.removeChild(this.element),e.appendChild(this.element)}addHeader(){const e=document.createElement("div");gadgetui.util.setStyle;e.classList.add("gadget-ui-collapsiblePane-header"),this.headerClass&&e.classList.add(this.headerClass),e.innerHTML=this.title,this.wrapper.insertBefore(e,this.element),this.header=this.wrapper.querySelector(this.headerClass?`div.${this.headerClass}`:"div.gadget-ui-collapsiblePane-header");const t=document.createElement("div");this.header.appendChild(t)}addCSS(){(0,gadgetui.util.setStyle)(this.wrapper,"width",this.width)}addBindings(){this.wrapper.querySelector(this.headerClass?`div.${this.headerClass}`:"div.gadget-ui-collapsiblePane-header").addEventListener("click",()=>this.toggle())}toggle(){const e=gadgetui.util.setStyle;let t,i,s,n;this.collapsed?(t="",i="block",s=this.height,n=this.selectorHeight,this.collapsed=!1):(t="",i="none",s=this.headerHeight,n=0,this.collapsed=!0);const a=this.collapsed?"collapse":"expand",o=this.collapsed?"minimized":"maximized";this.element.dispatchEvent(new Event(a)),"undefined"!=typeof Velocity&&this.animate?(Velocity(this.wrapper,{height:s},{queue:!1,duration:this.delay,complete:()=>{}}),Velocity(this.element,{height:n},{queue:!1,duration:this.delay,complete:()=>{this.fireEvent(o)}})):e(this.element,"display",i)}config(e={}){this.animate=e.animate??!0,this.delay=e.delay??300,this.title=e.title??"",this.width=gadgetui.util.getStyle(this.element,"width"),this.collapse=e.collapse??!1,this.collapsed=e.collapse??!0,this.class=e.class||!1,this.headerClass=e.headerClass||!1}},Dialog:class extends t{constructor(e,t={}){const i=gadgetui.util.setStyle;if(e)super(e,t);else{const e=document.createElement("div");e.setAttribute("id",`gadgetui-dialog-${Math.random()}`),t.width&&i(e,"width",t.width),document.body.appendChild(e),super(e,t)}this.buttons=t.buttons||[],this.addButtons()}events=["showPrevious","showNext"];addButtons(){const e=gadgetui.util.setStyle;this.buttonDiv=document.createElement("div"),e(this.buttonDiv,"text-align","center"),e(this.buttonDiv,"padding","0.5em"),this.buttons.forEach(e=>{const t=document.createElement("button");t.classList.add("gadgetui-dialog-button"),t.innerHTML=e.label,this.buttonDiv.appendChild(t),t.addEventListener("click",()=>{"function"==typeof e.action&&e.action()})}),this.element.appendChild(this.buttonDiv)}destroy(){super.destroy(),this.element.removeChild(this.buttonDiv)}},FileUploadWrapper:e,FloatingPane:t,Menu:class extends Component{constructor(e,t={}){super(),this.element=e,this.elements=[],this.config(t),this.datasource?this.retrieveData():this.data&&(this.addControl(),this.addBindings())}retrieveData(){this.datasource().then(e=>{this.data=e,this.addControl()})}regenerate(e=null){if(this.destroy(),null!==e)this.data=e,this.addControl(),this.addBindings();else{if(!this.datasource)return;this.retrieveData()}}addControl(){const e=(e,i)=>{const s=document.createElement("div");if(s.classList.add("gadget-ui-menu-item"),s.innerText=e.label||"",e.dataId?.length&&s.setAttribute("data-id",e.dataId),e.image?.length){const t=document.createElement("img");t.src=e.image,t.classList.add("gadget-ui-menu-icon"),s.appendChild(t)}return e.link&&(e.link.length>0||"function"==typeof e.link)&&(s.style.cursor="pointer",s.addEventListener("click",t=>{this.fireEvent("clicked",e),"function"==typeof e.link?e.link(t):window.open(e.link)})),e.menuItem&&s.appendChild(t(e.menuItem,s)),s},t=(t,i)=>{const s=document.createElement("div");return s.classList.add("gadget-ui-menu-menuItem"),t.items.forEach(t=>s.appendChild(e(t))),s};this.data.forEach(e=>{const i=(e=>{const i=document.createElement("div");if(i.classList.add("gadget-ui-menu"),i.innerText=e.label||"",e.image?.length){const t=document.createElement("img");t.src=e.image,t.classList.add("gadget-ui-menu-icon"),i.appendChild(t)}return i.appendChild(t(e.menuItem,i)),i})(e);this.element.appendChild(i),this.elements.push(i)})}addBindings(){const e=this.element.querySelectorAll(".gadget-ui-menu"),t=this.options.menuActivate||"mouseenter";document.addEventListener("click",e=>{this.element.contains(e.target)||this.close()});let i=null;e.forEach(e=>{const s=e.querySelector(".gadget-ui-menu-menuItem"),n=s.querySelectorAll(".gadget-ui-menu-item"),a=s.querySelectorAll(".gadget-ui-menu-menuItem");n.forEach(e=>{const s=e.querySelector(".gadget-ui-menu-menuItem");e.addEventListener(t,t=>{if(t.stopPropagation(),s){s.classList.add("gadget-ui-menu-hovering");const t=e.getBoundingClientRect();s.style.top=t.top+"px",i=e}e.classList.add("gadget-ui-menu-selected"),Array.from(e.parentNode.children).forEach(t=>{t!==e&&t.classList.remove("gadget-ui-menu-selected")}),t.preventDefault()}),"mouseenter"===t&&e.addEventListener("mouseleave",e=>{e.stopPropagation(),s&&s.classList.remove("gadget-ui-menu-hovering")})}),e.addEventListener(t,e=>{e.stopPropagation(),s.classList.add("gadget-ui-menu-hovering"),this.fireEvent("menuOpened",this)}),"mouseenter"===t&&e.addEventListener("mouseleave",e=>{e.stopPropagation(),s.classList.remove("gadget-ui-menu-hovering"),this.fireEvent("menuClosed",this)}),a.forEach(e=>{e.addEventListener(t,t=>{t.stopPropagation(),e.classList.add("gadget-ui-menu-hovering")}),"mouseenter"===t&&e.addEventListener("mouseleave",t=>{t.stopPropagation(),e.parentNode.classList.contains("selected")||e.classList.remove("gadget-ui-menu-hovering")})})}),window.addEventListener("scroll",()=>{if(i&&menuItem&&menuItem.classList.contains("gadget-ui-menu-hovering")){const e=i.getBoundingClientRect();menuItem.style.top=e.top+"px"}})}close(){this.elements.forEach(e=>{const t=e.querySelector(".gadget-ui-menu-menuItem");t&&(t.classList.remove("gadget-ui-menu-hovering"),this.fireEvent("menuClosed",this))})}destroy(){this.element.querySelectorAll(".gadget-ui-menu").forEach(e=>{this.element.removeChild(e)}),this.elements=[],this.fireEvent("menuRemoved",this)}config(e){this.datasource=e.datasource,this.data=e.data||[],this.options=e}},Lightbox:class extends Component{constructor(e,t={}){super(),this.element=e,this.config(t),this.addControl(),this.setImage()}events=["showPrevious","showNext"];config(e={}){this.images=e.images||[],this.currentIndex=0,this.time=e.time||3e3,this.enableModal=e.enableModal??!0,this.leftIcon=e.leftIcon||"/node_modules/feather-icons/dist/icons/chevron-left.svg",this.rightIcon=e.rightIcon||"/node_modules/feather-icons/dist/icons/chevron-right.svg",this.iconClass=e.iconClass||"feather",this.iconType=e.iconType||"img"}addControl(){this.element.classList.add("gadgetui-lightbox"),this.imageContainer=document.createElement("div"),this.imageContainer.classList.add("gadgetui-lightbox-image-container"),this.imageTag=document.createElement("img"),this.imageTag.setAttribute("name","image"),this.imageTag.classList.add("gadgetui-lightbox-image"),this.imageContainer.appendChild(this.imageTag),this.transitionImageTag=document.createElement("img"),this.transitionImageTag.setAttribute("name","transitionImage"),this.transitionImageTag.classList.add("gadgetui-lightbox-image"),this.transitionImageTag.classList.add("gadgetui-lightbox-transitionimage"),this.transitionImageTag.classList.add("gadgetui-hidden"),this.imageContainer.appendChild(this.transitionImageTag),this.spanPrevious=document.createElement("span"),this.spanNext=document.createElement("span"),this.spanPrevious.classList.add("gadgetui-lightbox-previousControl"),this.spanNext.classList.add("gadgetui-lightbox-nextControl"),this.spanPrevious.innerHTML="img"===this.iconType?`<img class="${this.iconClass}" src="${this.leftIcon}" alt="Previous">`:`<svg class="${this.iconClass}"><use xlink:href="${this.leftIcon}"/></svg>`,this.spanNext.innerHTML="img"===this.iconType?`<img class="${this.iconClass}" src="${this.rightIcon}" alt="Next">`:`<svg class="${this.iconClass}"><use xlink:href="${this.rightIcon}"/></svg>`,this.element.appendChild(this.spanPrevious),this.element.appendChild(this.imageContainer),this.element.appendChild(this.spanNext),this.spanPrevious.addEventListener("click",()=>this.prevImage()),this.spanNext.addEventListener("click",()=>this.nextImage()),this.enableModal&&(this.modal=document.createElement("div"),this.modal.classList.add("gadgetui-lightbox-modal"),this.modal.classList.add("gadgetui-hidden"),this.modalImageContainer=document.createElement("div"),this.modalImageContainer.classList.add("gadgetui-lightbox-modal-imagecontainer"),this.modalImageTag=document.createElement("img"),this.modalImageTag.classList.add("gadgetui-lightbox-image"),this.modalImageContainer.appendChild(this.modalImageTag),this.modal.appendChild(this.modalImageContainer),document.body.appendChild(this.modal),this.imageContainer.addEventListener("click",()=>{this.setModalImage(),this.element.classList.add("gadgetui-hidden"),this.modal.classList.remove("gadgetui-hidden"),this.stopAnimation()}),this.modal.addEventListener("click",()=>{this.modal.classList.add("gadgetui-hidden"),this.element.classList.remove("gadgetui-hidden"),this.animate()}))}nextImage(){this.currentIndex=(this.currentIndex+1)%this.images.length,this.updateImage(!0),this.fireEvent("showNext",{currentIndex:this.currentIndex})}prevImage(){this.currentIndex=(this.currentIndex-1+this.images.length)%this.images.length,this.updateImage(!1),this.fireEvent("showPrevious",{currentIndex:this.currentIndex})}setImage(){this.imageTag.src=this.images[this.currentIndex],this.imageTag.alt=`Image ${this.currentIndex+1}`}updateImage(e=!0){const t=this.images[this.currentIndex],i=`Image ${this.currentIndex+1}`;this.transitionImageTag.src=t,this.transitionImageTag.alt=i,this.transitionImageTag.classList.remove("gadgetui-hidden"),this.transitionImageTag.classList.remove("gadgetui-slide-left","gadgetui-slide-right","gadgetui-slide-in");const s=e?"gadgetui-slide-left":"gadgetui-slide-right";this.transitionImageTag.classList.add(s);const n=()=>{this.imageTag.src=t,this.imageTag.alt=i,this.transitionImageTag.classList.add("gadgetui-hidden"),this.transitionImageTag.classList.remove("gadgetui-slide-left","gadgetui-slide-right","gadgetui-slide-in"),this.transitionImageTag.removeEventListener("transitionend",n)};this.transitionImageTag.addEventListener("transitionend",n),requestAnimationFrame(()=>{this.transitionImageTag.offsetWidth,this.transitionImageTag.classList.add("gadgetui-slide-in")})}animate(){this.interval=setInterval(()=>this.nextImage(),this.time)}stopAnimation(){clearInterval(this.interval)}setModalImage(){this.modalImageTag.src=this.images[this.currentIndex],this.modalImageTag.alt=`Image ${this.currentIndex+1}`}},Modal:class extends Component{constructor(e,t={}){super(),this.element=e,this.config(t),this.addControl(),this.addBindings(),this.autoOpen&&this.open()}events=["opened","closed"];addControl(){this.wrapper=document.createElement("div"),this.class&&this.wrapper.classList.add(this.class),this.wrapper.classList.add("gadgetui-modal"),this.element.parentNode.insertBefore(this.wrapper,this.element),this.element.parentNode.removeChild(this.element),this.wrapper.appendChild(this.element);const e="img"===this.iconType?`<img class="${this.iconClass}" src="${this.closeIcon}"/>`:`<svg class="${this.iconClass}"><use xlink:href="${this.closeIcon}"/></svg>`;this.element.classList.add("gadgetui-modalWindow"),this.element.innerHTML=`\n    <span name="close" class="gadgetui-right-align">\n      <a name="close">${e}</a>\n    </span>\n    ${this.element.innerHTML}\n  `.trim()}addBindings(){this.element.querySelector('a[name="close"]').addEventListener("click",()=>this.close())}open(){this.wrapper.classList.add("gadgetui-showModal"),this.fireEvent("opened")}close(){this.wrapper.classList.remove("gadgetui-showModal"),this.fireEvent("closed")}destroy(){this.element.parentNode.removeChild(this.element),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),this.wrapper.parentNode.removeChild(this.wrapper),this.element.removeChild(this.element.querySelector(".gadgetui-right-align")),this.fireEvent("removed")}config(e){this.class=e.class||!1,this.iconClass=e.iconClass||"feather",this.closeIcon=e.closeIcon||"/node_modules/feather-icons/dist/icons/x-circle.svg",this.autoOpen=!1!==e.autoOpen,this.iconType=e.iconType||"img"}},Popover:class extends Component{constructor(e,t={}){super(),this.element=e,this.config(t),this.addControl(),this.addBindings(),this.autoOpen&&this.open()}events=["opened","closed"];addControl(){this.class&&this.element.classList.add(this.class),this.element.classList.add("gadgetui-popover")}addBindings(){}open(){this.element.classList.add("gadgetui-showPopover"),this.fireEvent("opened")}close(){this.element.classList.remove("gadgetui-showPopover"),this.fireEvent("closed")}destroy(){this.element.parentNode.removeChild(this.element),this.fireEvent("removed")}config(e){this.class=e.class||!1,this.autoOpen=!1!==e.autoOpen}},ProgressBar:class extends Component{constructor(e,t={}){super(),this.element=e,this.configure(t),this.render()}configure(e){this.id=e.id,this.label=e.label||"",this.width=e.width,this.percent=0}render(){const e=gadgetui.util.setStyle,t=document.createElement("div");t.setAttribute("name",`progressbox_${this.id}`),t.classList.add("gadgetui-progressbar-progressbox");const i=document.createElement("div");i.setAttribute("name","label"),i.classList.add("gadgetui-progressbar-label"),i.innerText=` ${this.label} `;const s=document.createElement("div");s.classList.add("gadget-ui-progressbar"),s.setAttribute("name",`progressbar_${this.id}`);const n=document.createElement("div");n.setAttribute("name","statustxt"),n.classList.add("gadgetui-progressbar-statustxt"),n.innerHTML="0%",t.appendChild(i),t.appendChild(s),t.appendChild(n),this.element.appendChild(t),this.progressbox=this.element.querySelector(`div[name='progressbox_${this.id}']`),this.progressbar=this.element.querySelector(`div[name='progressbar_${this.id}']`),this.statustxt=this.element.querySelector("div[name='statustxt']"),e(s,{width:"0%"})}start(){(0,gadgetui.util.setStyle)(this.progressbar,"width","0%"),this.statustxt.innerHTML="0%",this.fireEvent("start")}updatePercent(e){const t=gadgetui.util.setStyle;this.percent=e;const i=`${e}%`;t(this.progressbar,"width",i),this.statustxt.innerHTML=i,this.fireEvent("updatePercent",{percent:e})}update(e){this.statustxt.innerHTML=e,this.fireEvent("update",{text:e})}destroy(){this.progressbox&&this.progressbox.parentNode&&this.progressbox.parentNode.removeChild(this.progressbox),this.fireEvent("removed")}},Sidebar:class extends Component{constructor(e,t={}){super(),this.selector=e,this.minimized=!1,this.config(t),this.addControl(),this.addBindings(t)}events=["maximized","minimized"];config(e){this.class=e.class||!1,this.animate=e.animate??!0,this.delay=e.delay||300,this.toggleTitle=e.toggleTitle||"Toggle Sidebar",this.iconClass=e.iconClass||"feather",this.iconType=e.iconType||"img",this.leftIcon=e.leftIcon||"/node_modules/feather-icons/dist/icons/chevron-left.svg",this.rightIcon=e.rightIcon||"/node_modules/feather-icons/dist/icons/chevron-right.svg"}addControl(){this.wrapper=document.createElement("div"),this.class&&this.wrapper.classList.add(this.class),this.wrapper.classList.add("gadgetui-sidebar"),this.span=document.createElement("span"),this.span.setAttribute("title",this.toggleTitle),this.span.classList.add("gadgetui-right-align"),this.span.classList.add("gadgetui-sidebar-toggle"),this.span.innerHTML="img"===this.iconType?`<img class="${this.iconClass}" src="${this.leftIcon}">`:`<svg class="${this.iconClass}"><use xlink:href="${this.leftIcon}"/></svg>`,this.selector.parentNode.insertBefore(this.wrapper,this.selector),this.selector.parentNode.removeChild(this.selector),this.wrapper.appendChild(this.selector),this.wrapper.insertBefore(this.span,this.selector),this.width=this.wrapper.offsetWidth}maximize(){this.minimized=!1,this.setChevron(this.minimized),this.wrapper.classList.remove("gadgetui-sidebar-minimized"),"undefined"!=typeof Velocity&&this.animate?Velocity(this.wrapper,{width:this.width},{queue:!1,duration:this.delay,complete:()=>{this.selector.classList.remove("gadgetui-sidebarContent-minimized"),this.fireEvent("maximized")}}):(this.selector.classList.remove("gadgetui-sidebarContent-minimized"),this.fireEvent("maximized"))}minimize(){this.minimized=!0,this.setChevron(this.minimized),this.selector.classList.add("gadgetui-sidebarContent-minimized"),"undefined"!=typeof Velocity&&this.animate?Velocity(this.wrapper,{width:25},{queue:!1,duration:this.delay,complete:()=>{this.wrapper.classList.add("gadgetui-sidebar-minimized"),this.fireEvent("minimized")}}):(this.wrapper.classList.add("gadgetui-sidebar-minimized"),this.fireEvent("minimized"))}addBindings(e){this.span.addEventListener("click",()=>{this.minimized?this.maximize():this.minimize()}),e.minimized&&this.minimize()}setChevron(e){const t=e?this.rightIcon:this.leftIcon;this.wrapper.querySelector("span").innerHTML="img"===this.iconType?`<img class="${this.iconClass}" src="${t}">`:`<svg class="${this.iconClass}"><use xlink:href="${t}"/></svg>`}destroy(){}},Tabs:class extends Component{constructor(e,t={}){super(),this.element=e,this.tabsDiv=this.element.querySelector("div"),this.config(t),this.addControl()}config(e){this.direction=e.direction||"horizontal",this.tabContentDivIds=[],this.tabs=[],this.activeTab=null}events=["tabSelected"];addControl(){const e="vertical"===this.direction?"v":"h";this.tabsDiv.classList.add(`gadget-ui-tabs-${e}`),this.tabs=Array.from(this.tabsDiv.querySelectorAll("div"));let t=!1;this.tabs.forEach(i=>{i.classList.add(`gadget-ui-tab-${e}`);const s=i.getAttribute("data-tab");this.tabContentDivIds.push(s),this.element.querySelector(`div[name='${s}']`).style.display="none",t||(t=!0,this.setActiveTab(s)),i.addEventListener("click",()=>this.setActiveTab(s))}),this.element.querySelector(`div[name='${this.tabContentDivIds[0]}']`).style.display="block"}setActiveTab(e){const t="vertical"===this.direction?"v":"h";this.tabContentDivIds.forEach(t=>{const i=t===e?"block":"none";this.element.querySelector(`div[name='${t}']`).style.display=i}),this.tabs.forEach(i=>{const s=i.getAttribute("data-tab"),n=`gadget-ui-tab-${t}-active`;s===e?(i.classList.add(n),i.classList.remove(`gadget-ui-tab-${t}`)):(i.classList.add(`gadget-ui-tab-${t}`),i.classList.remove(n))}),this.activeTab=e,this.fireEvent("tabSelected",{activeTab:e})}destroy(){}}}}(),gadgetui.input={Autosuggest:class extends Component{constructor(e,t={}){if(super(),this.items=[],this.events=["added","removed","change","focus","blur","keydown","keypress","input","mousedown","menuselect","response","click"],this.config(t),this.createAtCursor){if(this.cursorPosition=this.createElementAtCursor(),!this.cursorPosition)throw new Error("Cannot create element at cursor: no selection found");this.element=this.cursorPosition.element}else if(this.element=e,!this.element)throw new Error("Element is required when createAtCursor is false");this.setIsMultiLine(),this.addControl(),this.initSource(),this.addMenu(),this.addBindings()}addControl(){if(this.wrapper=document.createElement("div"),this.width&&gadgetui.util.setStyle(this.wrapper,"width",this.width),this.wrapper.classList.add("gadgetui-autosuggest-input"),this.createAtCursor&&this.cursorPosition){const e=this.cursorPosition.range;e.commonAncestorContainer,this.wrapper.appendChild(this.element),e.insertNode(this.wrapper);const t=document.createRange();t.selectNodeContents(this.element),t.collapse(!1);const i=window.getSelection();i.removeAllRanges(),i.addRange(t)}else this.element.parentNode.insertBefore(this.wrapper,this.element),this.element.parentNode.removeChild(this.element),this.wrapper.appendChild(this.element)}createElementAtCursor(){const e=window.getSelection();if(!e.rangeCount)return null;const t=e.getRangeAt(0),i=document.createElement(this.elementType);return i.setAttribute("contenteditable","true"),i.classList.add("gadgetui-autosuggest-dynamic"),{element:i,range:t,selection:e}}addMenu(){const e=document.createElement("div");if(e.classList.add("gadgetui-autosuggest-menu"),gadgetui.util.setStyle(e,"display","none"),this.usePopover){const t={...this.popoverOptions,autoOpen:!1};this.popover=new gadgetui.display.Popover(e,t),this.menu={element:e,popover:this.popover}}else this.menu={element:e};this.wrapper.appendChild(e)}initSource(){Array.isArray(this.datasource)?this.source=(e,t)=>t(this.filter(this.datasource,e.term)):"string"==typeof this.datasource?this.source=(e,t)=>{this.xhr&&this.xhr.abort(),this.xhr=fetch({url:this.datasource,data:e,dataType:"json",success:e=>t(e),error:()=>t([])})}:"function"==typeof this.datasource&&"AsyncFunction"===this.datasource.constructor.name?this.source=async(e,t)=>{try{t(await this.datasource(e))}catch(e){console.error("Error in async datasource:",e),t([])}}:this.source=this.datasource}escapeRegex(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}_filter(e,t){const i=new RegExp(this.escapeRegex(t),"i");return gadgetui.util.grep(e,e=>i.test(e.label||e.value||e))}checkForDuplicate(e){return this.items.some(t=>t===e)}setIsMultiLine(){const e=this.element.nodeName.toLowerCase();this.isMultiLine="textarea"===e||"input"!==e&&(this.element.isContentEditable||"true"===this.element.getAttribute("contenteditable"))}addBindings(){const e=this.element.nodeName.toLowerCase();let t,i,s;this.isTextarea="textarea"===e,this.isInput="input"===e,this.valueMethod=this.isTextarea||this.isInput?"value":"innerHTML",this.element.setAttribute("autocomplete","off"),this.wrapper.addEventListener("click",()=>{this.element.focus(),this.fireEvent("click")});const n={keydown:e=>{if(this.element.getAttribute("readOnly"))return void(t=s=i=!0);t=s=i=!1;const n=gadgetui.keyCode;switch(e.keyCode){case n.PAGE_UP:t=!0,this._move("previousPage",e);break;case n.PAGE_DOWN:t=!0,this._move("nextPage",e);break;case n.UP:t=!0,this._keyEvent("previous",e);break;case n.DOWN:t=!0,this._keyEvent("next",e);break;case n.ENTER:this.menu.active&&(t=!0,e.preventDefault(),this.menu.select(e));break;case n.BACKSPACE:!this.element.value.length&&this.items.length&&this.remove(this.element.previousSibling);break;case n.TAB:this.menu.active&&this.menu.select(e);break;case n.ESCAPE:"none"!==this.menu.element.style.display&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:i=!0,this._searchTimeout(e)}this.fireEvent("keydown")},keypress:e=>{if(t)return t=!1,void(this.isMultiLine&&"none"===this.menu.element.style.display||e.preventDefault());if(i)return;const s=gadgetui.keyCode;switch(e.keyCode){case s.PAGE_UP:this._move("previousPage",e);break;case s.PAGE_DOWN:this._move("nextPage",e);break;case s.UP:this._keyEvent("previous",e);break;case s.DOWN:this._keyEvent("next",e)}this.fireEvent("keypress")},input:e=>{if(s)return s=!1,void e.preventDefault();this._searchTimeout(e),this.fireEvent("input")},focus:()=>{this.selectedItem=null,this.previous=this.element[this.valueMethod],this.fireEvent("focus")},blur:e=>{this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this.fireEvent("blur"))},change:()=>this.fireEvent("change")};Object.entries(n).forEach(([e,t])=>{this.element.addEventListener(e,t)}),this.menu.element.addEventListener("mousedown",e=>{e.preventDefault(),this.cancelBlur=!0,gadgetui.util.delay(()=>delete this.cancelBlur),this.fireEvent("mousedown")}),this.menu.element.addEventListener("menuselect",e=>{const t=e.detail,i=this.previous;this.menu.element!==document.activeElement&&(this.menu.element.focus(),this.previous=i,gadgetui.util.delay(()=>{this.previous=i,this.selectedItem=t})),this._value(t.value),this.term=this._value(),this.close(e),this.selectedItem=t,this.handler(t),this.fireEvent("menuselect")})}_renderItem(e){const t=document.createElement("div");t.classList.add("gadgetui-autosuggest-input-item-wrapper");const i=document.createElement("div");return i.classList.add("gadgetui-autosuggest-input-item"),i.innerHTML=this.labelRenderer(e),t.appendChild(i),t}_renderItemCancel(e,t){const i=gadgetui.util.setStyle,s=document.createElement("span"),n=gadgetui.util.getNumberValue(gadgetui.util.getStyle(t,"width"))+6;return s.classList.add("oi"),s.setAttribute("data-glyph","circle-x"),i(s,"opacity",".5"),i(s,"left",n),i(s,"position","absolute"),i(s,"cursor","pointer"),i(s,"top",3),s}reset(){for(;this.wrapper.firstChild&&this.wrapper.firstChild!==this.element;)this.wrapper.removeChild(this.wrapper.firstChild);if(this.items=[],this.model){const e=this.element.getAttribute("gadgetui-bind");e&&this.model.set(e,[])}}destroy(){if(clearTimeout(this.searching),this.usePopover&&this.menu.popover&&this.menu.popover.destroy(),this.menu.element.remove(),this.liveRegion&&this.liveRegion.remove(),this.createAtCursor&&this.wrapper&&this.wrapper.parentNode){const e=this.element.textContent||"";if(e){const t=document.createTextNode(e);this.wrapper.parentNode.replaceChild(t,this.wrapper)}else this.wrapper.parentNode.removeChild(this.wrapper)}}_setOption(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()}_appendTo(){let e=this.options.appendTo;return e||(e=this.element.closest(".ui-front")||document.body),e.jquery||e.nodeType?$(e):this.document.find(e).eq(0)}_searchTimeout(e){clearTimeout(this.searching),this.searching=gadgetui.util.delay(()=>{const t=this.term!==this.element.value,i="none"!==this.menu.element.style.display,s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;!t&&(t||i||s)||(this.selectedItem=null,this.search(null,e))},this.delay)}search(e,t){return e=e??this._value(),this.term=this._value(),e.length<this.minLength?this.close(t):this._search(e)}showAll(){this.term=this._value(),this._search(this.term||"")}_search(e){this.pending++,this.cancelSearch=!1,this.source({term:e},this._response())}_response(){const e=++this.requestIndex;return t=>{e===this.requestIndex&&(this.__response(t),this.pending--)}}__response(e){(!this.labelRenderer||this.labelRenderer===this._renderLabel)&&e?.length&&(e=this._normalize(e)),this.element.dispatchEvent(new CustomEvent("response",{detail:{content:e}})),this.fireEvent("response",e),this.disabled||!e?.length||this.cancelSearch||this.suppressSuggestions?this._close():(this._suggest(e),this.element.dispatchEvent(new Event("open")))}close(e){this.cancelSearch=!0,this._close(e)}_close(){"none"!==this.menu.element.style.display&&(this.usePopover&&this.menu.popover&&this.menu.popover.close(),this.menu.element.style.display="none",this.menu.element.blur(),this.isNewMenu=!0)}_normalize(e){return e.length&&e[0].label&&e[0].value?e:e.map(e=>"string"==typeof e?{label:e,value:e}:{label:e.label||e.value,value:e.value||e.label})}_suggest(e){const t=this.menu.element;for(;t.firstChild;)t.removeChild(t.firstChild);this._renderMenu(e),this.usePopover&&this.menu.popover?(t.style.display="block",this.menu.popover.open()):t.style.display="block",this._resizeMenu(),this.position.of=this.element,this.isNewMenu=!0}_resizeMenu(){}_renderMenu(e){const t=Math.min(this.maxSuggestions,e.length);for(let i=0;i<t;i++)this._renderItemData(e[i])}_renderItemData(e){const t=this.menuItemRenderer(e);t.addEventListener("click",()=>{this.menu.element.dispatchEvent(new CustomEvent("menuselect",{detail:e}))}),this.menu.element.appendChild(t)}_renderMenuItem(e){const t=document.createElement("div");return t.classList.add("gadgetui-autosuggest-item"),t.setAttribute("value",e.value),t.innerText=this.labelRenderer(e),t}_renderLabel(e){return e.label}_move(e,t){if("none"===this.menu.element.style.display)return void this.search(null,t);const i=this.menu.element.querySelectorAll(".gadgetui-autosuggest-item");if(0===i.length)return;let s=!1,n=!1;return i.length>0&&i[0].classList.contains("ui-state-focus")&&(s=!0),i.length>0&&i[i.length-1].classList.contains("ui-state-focus")&&(n=!0),s&&/^previous/.test(e)||n&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void 0}widget(){return this.menu.element}_value(e){return void 0!==e&&(this.element[this.valueMethod]=e),this.element[this.valueMethod]}_keyEvent(e,t){this.isMultiLine&&"none"===this.menu.element.style.display||(this._move(e,t),t.preventDefault())}config(e){this.model=this?.element&&this.element.getAttribute("gadgetui-bind")&&!e.model?gadgetui.model:e.model,this.width=e.width,this.handler=e.handler,this.filter=e.filter||this._filter,this.labelRenderer=e.labelRenderer||this._renderLabel,this.menuItemRenderer=e.menuItemRenderer||this._renderMenuItem,this.itemCancelRenderer=e.itemCancelRenderer||this._renderItemCancel,this.emitEvents=e.emitEvents??!0,this.datasource=e.datasource??(e.data||!0),this.minLength=e.minLength||0,this.disabled=e.disabled||!1,this.maxSuggestions=e.maxSuggestions||20,this.position=e.position||{my:"left top",at:"left bottom",collision:"none"},this.suppressSuggestions=e.suppressSuggestions||!1,this.autoFocus=e.autoFocus||!1,this.requestIndex=0,this.delay=e.delay||300,this.createAtCursor=e.createAtCursor||!1,this.elementType=e.elementType||"span",this.usePopover=e.usePopover||!1,this.popoverOptions=e.popoverOptions||{}}},FileUploader:class extends Component{constructor(e,t={}){super(),this.element=e,this.droppedFiles=[],this.configure(t),this.render(t.title),this.setEventHandlers(),this.setDimensions(),this.token=this.useTokens&&sessionStorage?sessionStorage.token:null}render(e=""){const t=gadgetui.util.setStyle,i=`gadgetui-fileuploader-uploadIcon ${this.uploadClass||""}`.trim(),s=this.uploadIcon.includes(".svg")?`<svg name="gadgetui-fileuploader-uploadIcon" class="${i}"><use xlink:href="${this.uploadIcon}"/></svg>`:`<img name="gadgetui-fileuploader-uploadIcon" class="${i}" src="${this.uploadIcon}">`;if(this.element.innerHTML=`\n      <div class="gadgetui-fileuploader-wrapper">\n        <div name="gadgetui-fileuploader-dropzone" class="gadgetui-fileuploader-dropzone">\n          <div name="gadgetui-fileuploader-filedisplay" class="gadgetui-fileuploader-filedisplay" style="display:none;"></div>\n          <div class="gadgetui-fileuploader-dropmessage" name="gadgetui-fileuploader-dropMessageDiv">${this.dropMessage}</div>\n        </div>\n        <div class="buttons full">\n          <div class="gadgetui-fileuploader-fileUpload" name="gadgetui-fileuploader-fileUpload">\n            <label>${s}<input type="file" name="gadgetui-fileuploader-fileselect" class="gadgetui-fileuploader-upload" title=""></label>\n          </div>\n        </div>\n      </div>\n    `.trim(),this.showUploadButton||t(this.element.querySelector('input[name="gadgetui-fileuploader-fileselect"]'),"display","none"),this.showDropZone||t(this.element.querySelector('div[name="gadgetui-fileuploader-dropzone"]'),"display","none"),!this.showUploadIcon){const e=this.element.querySelector('[name="gadgetui-fileuploader-uploadIcon"]');e&&t(e,"display","none")}this.renderDropZone()}configure(e){this.message=e.message,this.tags=e.tags||"",this.uploadURI=e.uploadURI,this.onUploadComplete=e.onUploadComplete,this.willGenerateThumbnails=e.willGenerateThumbnails??!1,this.showUploadButton=e.showUploadButton??!0,this.showDropZone=e.showDropZone??!0,this.uploadIcon=e.uploadIcon||"/node_modules/feather-icons/dist/feather-sprite.svg#image",this.uploadClass=e.uploadClass||"",this.showUploadIcon=!(!e.uploadIcon||!e.showUploadIcon),this.addFileMessage=e.addFileMessage||"Add a File",this.dropMessage=e.dropMessage||"Drop Files Here",this.uploadErrorMessage=e.uploadErrorMessage||"Upload error.",this.useTokens=e.useTokens??!1,this.tokenType=e.tokenType??"access_token",this.allowedFileTypes=e.allowedFileTypes||null,this.allowedExtensions=e.allowedExtensions||null,this.invalidFileTypeMessage=e.invalidFileTypeMessage||"Invalid file type. Please select a valid file.",this.maxFileSize=e.maxFileSize||null,this.maxFileSizeByType=e.maxFileSizeByType||null,this.fileSizeExceededMessage=e.fileSizeExceededMessage||"File size exceeds the maximum allowed limit.",this.beforeUpload=e.beforeUpload||null}setDimensions(){gadgetui.util.setStyle,this.element.querySelector(".gadgetui-fileuploader-dropzone"),this.element.querySelector(".gadgetui-fileuploader-filedisplay"),this.element.querySelector(".buttons")}setEventHandlers(){this.element.querySelector('input[name="gadgetui-fileuploader-fileselect"]').addEventListener("change",async e=>{const t=this.element.querySelector('div[name="gadgetui-fileuploader-dropzone"]'),i=this.element.querySelector('div[name="gadgetui-fileuploader-filedisplay"]');let s;s=this.beforeUpload&&"function"==typeof this.beforeUpload?await this.beforeUpload(e.target.files):Array.from(e.target.files),this.processUpload(e,s,t,i)})}renderDropZone(){const e=this.element.querySelector('div[name="gadgetui-fileuploader-dropzone"]'),t=this.element.querySelector('div[name="gadgetui-fileuploader-filedisplay"]');this.element.addEventListener("dragstart",e=>{e.dataTransfer.setData("text","data"),e.dataTransfer.effectAllowed="copy",this.fireEvent("dragstart")}),e.addEventListener("dragenter",t=>{t.preventDefault(),t.stopPropagation(),e.classList.add("highlighted"),this.fireEvent("dragenter")}),e.addEventListener("dragleave",t=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("highlighted"),this.fireEvent("dragleave")}),e.addEventListener("dragover",e=>{this.handleDragOver(e),e.dataTransfer.dropEffect="copy",this.fireEvent("dragover")}),e.addEventListener("drop",async i=>{let s;i.preventDefault(),i.stopPropagation(),this.fireEvent("drop"),s=this.beforeUpload&&"function"==typeof this.beforeUpload?await this.beforeUpload(i.dataTransfer.files):Array.from(evt.target.files),this.processUpload(i,s,e,t)})}processUpload(e,t,i,s){const n=gadgetui.util.setStyle;this.uploadingFiles=[],n(s,"display","inline"),t.forEach(e=>{if(!this.validateFileType(e))return void this.handleInvalidFileType(e);if(!this.validateFileSize(e))return void this.handleFileSizeExceeded(e);const t=new gadgetui.display.FileUploadWrapper(e,s);this.uploadingFiles.push(t),t.on("uploadComplete",e=>{const t=this.uploadingFiles.findIndex(t=>t.id===e.id);-1!==t&&this.uploadingFiles.splice(t,1),this.uploadingFiles.length||(this.showDropZone&&this.show("dropzone"),this.setDimensions()),this.fireEvent("uploadComplete")})}),i.classList.remove("highlighted"),this.handleFileSelect(this.uploadingFiles,e)}validateFileType(e){if(!this.allowedFileTypes&&!this.allowedExtensions)return!0;if(this.allowedExtensions){const t=e.name.split(".").pop().toLowerCase();if(Array.isArray(this.allowedExtensions)){if(!this.allowedExtensions.includes(t))return!1}else if(this.allowedExtensions!==t)return!1}if(this.allowedFileTypes)if(Array.isArray(this.allowedFileTypes)){if(!this.allowedFileTypes.includes(e.type))return!1}else if(this.allowedFileTypes!==e.type)return!1;return!0}handleInvalidFileType(e){const t=this.invalidFileTypeMessage,i=document.createElement("div");i.className="gadgetui-fileuploader-error",i.innerText=`${t} (${e.name})`,this.element.querySelector(".gadgetui-fileuploader-filedisplay").appendChild(i),this.fireEvent("invalidFileType",{file:e,message:t})}validateFileSize(e){if(!this.maxFileSize&&!this.maxFileSizeByType)return!0;if(this.maxFileSize&&e.size>this.maxFileSize)return!1;if(this.maxFileSizeByType){let t=null;if(Array.isArray(this.maxFileSizeByType)){const i=this.maxFileSizeByType.find(t=>t.type===e.type||t.extensions&&t.extensions.includes(e.name.split(".").pop().toLowerCase()));t=i?i.size:null}else"object"==typeof this.maxFileSizeByType&&(t=this.maxFileSizeByType[e.type]||this.maxFileSizeByType[e.name.split(".").pop().toLowerCase()]||null);if(t&&e.size>t)return!1}return!0}handleFileSizeExceeded(e){const t=this.fileSizeExceededMessage,i=document.createElement("div");i.className="gadgetui-fileuploader-error",i.innerText=`${t} (${e.name})`,this.element.querySelector(".gadgetui-fileuploader-filedisplay").appendChild(i),this.fireEvent("fileSizeExceeded",{file:e,message:t})}handleFileSelect(e,t){t.preventDefault(),t.stopPropagation();const i=e.filter(e=>!1!==e.isValid&&!1!==e.sizeValid);this.willGenerateThumbnails?this.generateThumbnails(i):this.upload(i)}generateThumbnails(e){this.upload(e)}upload(e){const t=e.filter(e=>!1!==e.isValid&&!1!==e.sizeValid);0!==t.length?(t.forEach(e=>{this.fireEvent("uploadStart"),e.progressbar.start()}),this.uploadFile(t)):this.fireEvent("uploadComplete")}uploadFile(e){e.forEach(e=>{const t=e.file,i=1048576,s=Math.ceil(t.size/i),n=[];let a=0;for(;a<t.size;){const e=Math.min(a+i,t.size);n.push(t.slice(a,e)),a=e}this.uploadChunk(e,n,1,s)})}uploadChunk(e,t,i,s){const n=new XMLHttpRequest,a=this.tags;n.onreadystatechange=()=>{if(4===n.readyState)if(200!==n.status)this.handleUploadError(n,{},e);else if(this.useTokens&&sessionStorage&&("X-Token"===this.tokenType?this.token=n.getResponseHeader("X-Token"):this.token=n.getResponseHeader("access_token"),sessionStorage.token=this.token),i<=s&&e.progressbar.updatePercent(Math.round(i/s*100)),i<s)e.id=n.getResponseHeader("X-Id"),e.key=n.getResponseHeader("X-Key"),this.uploadChunk(e,t,i+1,s);else{let t;try{t={data:JSON.parse(n.response)}}catch(i){return t={},void this.handleUploadError(n,t,e)}t.data?this.handleUploadResponse(t,e):this.handleUploadError(n,t,e)}},n.open("POST",this.uploadURI,!0),n.setRequestHeader("X-Tags",a),n.setRequestHeader("X-Id",e.id||""),n.setRequestHeader("X-Key",e.key||""),n.setRequestHeader("X-FileName",e.file.name),n.setRequestHeader("X-FileSize",e.file.size),n.setRequestHeader("X-FilePart",i),n.setRequestHeader("X-Parts",s),this.useTokens&&this.token&&("X-Token"===this.tokenType?n.setRequestHeader("X-Token",this.token):n.setRequestHeader("Authorization","Bearer "+this.token)),n.setRequestHeader("X-MimeType",e.file.type||"application/octet-stream"),n.setRequestHeader("X-HasTile",!!e.tile?.length),n.setRequestHeader("Content-Type","application/octet-stream"),n.send(t[i-1])}handleUploadResponse(e,t){const i=gadgetui.objects.Constructor(gadgetui.objects.FileItem,[{mimetype:e.data.mimetype,fileid:e.data.fileId,filename:e.data.filename,filesize:e.data.filesize,tags:e.data.tags,created:e.data.created,createdStr:e.data.created,disabled:e.data.disabled,path:e.data.path}],!1);t.completeUpload(i),this.onUploadComplete&&this.onUploadComplete(i)}handleUploadError(e,t,i){i.progressbar.progressbox.innerText=this.uploadErrorMessage,i.abortUpload(i)}show(e){const t=gadgetui.util.setStyle,i=this.element.querySelector(".gadgetui-fileuploader-dropzone"),s=this.element.querySelector(".gadgetui-fileuploader-filedisplay");"dropzone"===e?(t(i,"display","table-cell"),t(s,"display","none")):(t(s,"display","table-cell"),t(i,"display","none"))}handleDragOver(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"}},TextInput:class extends Component{constructor(e,t={}){super(),this.emitEvents=!0,this.model=gadgetui.model,this.selector=e,this.config(t),this.setInitialValue(),this.addControl(),this.setLineHeight(),this.setFont(),this.setWidth(),gadgetui.util.bind(this.selector,this.model),this.addBindings()}addControl(){this.hideable&&(this.blockSize=gadgetui.util.getStyle(this.selector,"block-size"),gadgetui.util.setStyle(this.selector,"block-size",this.blockSize),this.selector.classList.add(this.browserHideBorderCSS))}setInitialValue(){const e=this.selector.value,t=this.selector.getAttribute("placeholder");this.value=e||(t&&t.length>0?t:" ... ")}setLineHeight(){this.lineHeight=this.selector.offsetHeight}setFont(){const e=gadgetui.util.getStyle(this.selector);this.font=`${e.fontFamily} ${e.fontSize} ${e.fontWeight} ${e.fontVariant}`}setWidth(){this.width=gadgetui.util.textWidth(this.selector.value,this.font)+10||this.maxWidth}addCSS(){const e=gadgetui.util.setStyle;this.selector.classList.add("gadgetui-textinput"),this.maxWidth>10&&this.enforceMaxWidth&&e(this.selector,"max-width",this.maxWidth)}setControlWidth(e){const t=Math.max(parseInt(gadgetui.util.textWidth(e,this.font),10),this.minWidth);gadgetui.util.setStyle(this.selector,"width",`${t+30}px`)}addBindings(){const e={mouseenter:()=>{this.hideable&&this.selector.classList.remove(this.browserHideBorderCSS),this.fireEvent("mouseenter")},focus:()=>{this.hideable&&this.selector.classList.remove(this.browserHideBorderCSS),this.fireEvent("focus")},keyup:e=>{13===e.keyCode&&this.selector.blur(),this.setControlWidth(this.selector.value),this.fireEvent("keyup")},change:e=>{setTimeout(()=>{let t=e.target.value||this.selector.getAttribute("placeholder")||"";const i=gadgetui.util.textWidth(t,this.font);this.maxWidth<i&&(t=gadgetui.util.fitText(t,this.font,this.maxWidth)),this.model&&!this.selector.getAttribute("gadgetui-bind")&&this.model.set(this.selector.name,e.target.value),this.emitEvents&&gadgetui.util.trigger(this.selector,"gadgetui-input-change",{text:e.target.value}),this.func&&this.func({text:e.target.value}),this.fireEvent("change")},200)}};Object.entries(e).forEach(([e,t])=>{this.selector.addEventListener(e,e=>{e.preventDefault(),t(e)})}),this.hideable&&(this.selector.addEventListener("mouseleave",()=>{this.selector!==document.activeElement&&this.selector.classList.add(this.browserHideBorderCSS),this.fireEvent("mouseleave")}),this.selector.addEventListener("blur",()=>{gadgetui.util.setStyle(this.selector,"maxWidth",this.maxWidth),this.selector.classList.add(this.browserHideBorderCSS),this.fireEvent("blur")}))}config(e){this.borderColor=e.borderColor||"#d0d0d0",this.useActive=e.useActive||!1,this.model=e.model||this.model,this.func=e.func,this.emitEvents=e.emitEvents??!0,this.activate=e.activate||"mouseenter",this.delay=e.delay||10,this.minWidth=e.minWidth||100,this.enforceMaxWidth=e.enforceMaxWidth||!1,this.hideable=e.hideable||!1,this.maxWidth=e.maxWidth||gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.selector.parentNode).width),this.browserHideBorderCSS=`gadget-ui-textinput-hideBorder-${gadgetui.util.checkBrowser()}`}},SelectInput:class extends Component{constructor(e,t={}){super(),this.selector=e,this.config(t),this.setSelectOptions(),this.setInitialValue(t),this.addControl(),this.addCSS();const i=gadgetui.util.setStyle;this.hideable?i(this.selector,"display","none"):(i(this.label,"display","none"),i(this.selector,"display","inline-block")),gadgetui.util.bind(this.selector,this.model),gadgetui.util.bind(this.label,this.model),this.addBindings()}setInitialValue(e){const t=this.selector.selectedIndex||0;this.value=e.value||{id:this.selector.options[t].value,text:this.selector.options[t].innerHTML},this.selector.value=this.value.id}addControl(){this.wrapper=document.createElement("div"),this.label=document.createElement("div"),this.wrapper.classList.add("gadgetui-selectinput-div"),this.label.classList.add("gadgetui-selectinput-label"),this.label.setAttribute("gadgetui-bind",this.selector.getAttribute("gadgetui-bind")||""),this.label.innerHTML=this.value.text,this.selector.parentNode.insertBefore(this.wrapper,this.selector),this.selector.parentNode.removeChild(this.selector),this.wrapper.appendChild(this.selector),this.wrapper.insertBefore(this.label,this.selector)}setSelectOptions(){const e=this.selector.getAttribute("gadgetui-bind-options");if(!e&&!this.dataProvider)return;for(;this.selector.options.length>0;)this.selector.remove(0);const t=(e,t)=>{const i=document.createElement("option");i.value=e,i.text=t,this.selector.add(i)};e?this.model.get(e).forEach(e=>{const i="object"==typeof e;t(i?e.id:e,i?e.text:e)}):this.dataProvider&&this.dataProvider.data.forEach(e=>t(e.id,e.text||e.id))}addCSS(){const e=gadgetui.util.setStyle,t=(gadgetui.util.getStyle(this.selector),gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.selector.parentNode).height)-2);e(this.selector,"min-width","100px"),e(this.label,"padding-top","2px"),e(this.label,"height",`${t}px`),e(this.label,"margin-left","9px");const i=navigator.userAgent;i.match(/Edge/)?e(this.selector,"margin-left","5px"):i.match(/MSIE/)&&(e(this.selector,"margin-top","0px"),e(this.selector,"margin-left","5px"))}addBindings(){const e=gadgetui.util.setStyle;this.hideable&&(this.label.addEventListener(this.activate,t=>{t.preventDefault(),e(this.label,"display","none"),e(this.selector,"display","inline-block"),this.fireEvent(this.activate)}),this.selector.addEventListener("blur",()=>{e(this.label,"display","inline-block"),e(this.selector,"display","none"),this.fireEvent("blur")}),this.selector.addEventListener("mouseleave",()=>{this.selector!==document.activeElement&&(e(this.label,"display","inline-block"),e(this.selector,"display","none")),this.fireEvent("mouseleave")})),this.selector.addEventListener("change",e=>{setTimeout(()=>{const t=e.target.value||"0",i=e.target[e.target.selectedIndex].innerHTML;this.label.innerText=i;const s={id:t,text:i};this.model&&!this.selector.getAttribute("gadgetui-bind")&&this.model.set(this.selector.name,s),this.emitEvents&&gadgetui.util.trigger(this.selector,"gadgetui-input-change",s),this.func&&this.func(s),this.value=s},100),this.fireEvent("change")})}config(e){this.model=e.model,this.dataProvider=e.dataProvider,this.func=e.func,this.emitEvents=e.emitEvents??!0,this.activate=e.activate||"mouseenter",this.hideable=e.hideable||!1}},ComboBox:class extends Component{constructor(e,t){super(),this.emitEvents=!0,this.model=gadgetui.model,this.func=void 0,this.element=e,this.config(t),this.setSaveFunc(),this.setDataProviderRefresh(),this.addControl(),this.addCSS(),gadgetui.util.bind(this.element,this.model),gadgetui.util.bind(this.label,this.model),this.addBehaviors(),this.setStartingValues()}addControl(){gadgetui.util.setStyle,this.comboBox=gadgetui.util.createElement("div"),this.input=gadgetui.util.createElement("input"),this.label=gadgetui.util.createElement("div"),this.inputWrapper=gadgetui.util.createElement("div"),this.selectWrapper=gadgetui.util.createElement("div"),this.comboBox.classList.add("gadgetui-combobox"),this.input.classList.add("gadgetui-combobox-input"),this.label.classList.add("gadgetui-combobox-label"),this.inputWrapper.classList.add("gadgetui-combobox-inputwrapper"),this.selectWrapper.classList.add("gadgetui-combobox-selectwrapper"),this.element.parentNode.insertBefore(this.comboBox,this.element),this.element.parentNode.removeChild(this.element),this.comboBox.appendChild(this.label),this.selectWrapper.appendChild(this.element),this.comboBox.appendChild(this.selectWrapper),this.inputWrapper.appendChild(this.input),this.comboBox.appendChild(this.inputWrapper),this.label.setAttribute("data-id",this.id),this.label.setAttribute("gadgetui-bind",this.element.getAttribute("gadgetui-bind")),this.label.innerHTML=this.text,this.input.setAttribute("placeholder",this.newOption.text),this.input.setAttribute("type","text"),this.input.setAttribute("name","custom")}addCSS(){var e=gadgetui.util.setStyle;this.element.classList.add("gadgetui-combobox-select"),e(this.element,"width",this.width),gadgetui.util.getStyle(this.element);var t,i,s=this.element.clientWidth,n=0,a=0,o=this.borderWidth;i=gadgetui.util.getNumberValue(this.borderWidth)+4,this.borderRadius>5&&(a=this.borderRadius-5,i=gadgetui.util.getNumberValue(i)+gadgetui.util.getNumberValue(a)),t=s-this.arrowWidth-gadgetui.util.getNumberValue(this.borderRadius)-4,navigator.userAgent.match(/(Safari)/)&&!navigator.userAgent.match(/(Chrome)/)?(o=this.borderWidth-2,a=a<4?4:this.borderRadius-1,n=1):navigator.userAgent.match(/Edge/)||navigator.userAgent.match(/MSIE/)?a=a<1?1:this.borderRadius-4:navigator.userAgent.match(/Trident/)?a=a<2?2:this.borderRadius-3:navigator.userAgent.match(/Chrome/)&&(a=a<4?4:this.borderRadius-1,n=1),e(this.element,"margin-top",n),e(this.element,"padding-left",a),e(this.inputWrapper,"top",o),e(this.inputWrapper,"left",0),e(this.input,"width",t),e(this.label,"left",i),navigator.userAgent.match(/Firefox/)&&!0===this.scaleIconHeight&&e(this.selectWrapper,"background-size",this.arrowWidth+"px "+inputHeight+"px"),e(this.element,"-webkit-appearance","none"),e(this.element,"-moz-appearance","window"),!0===this.scaleIconHeight&&e(this.element,"background-size",this.arrowWidth+"px "+inputHeight+"px"),this.hideable?(e(this.inputWrapper,"display","none"),e(this.selectWrapper,"display","none")):(e(this.selectWrapper,"display","inline"),e(this.label,"display","none"),this.element.selectedIndex<=0&&e(this.inputWrapper,"display","inline"))}setSelectOptions(){for(var e,t,i;this.element.options.length>0;)this.element.remove(0);(i=gadgetui.util.createElement("option")).value=this.newOption.id,i.text=this.newOption.text,this.element.add(i),this.dataProvider.data.forEach(s=>{e=s.id,void 0===(t=s.text)&&(t=e),(i=gadgetui.util.createElement("option")).value=e,i.text=t,this.element.add(i)})}find(e){var t;for(t=0;t<this.dataProvider.data.length;t++)if(this.dataProvider.data[t].text===e)return this.dataProvider.data[t].id}getText(e){var t,i=parseInt(e,10);for(!0===isNaN(i)&&(i=e),t=0;t<this.dataProvider.data.length;t++)if(this.dataProvider.data[t].id===i)return this.dataProvider.data[t].text}showLabel(){var e=gadgetui.util.setStyle;e(this.label,"display","inline-block"),e(this.selectWrapper,"display","none"),e(this.inputWrapper,"display","none")}addBehaviors(e){this.hideable&&(this.comboBox.addEventListener(this.activate,()=>{setTimeout(()=>{"none"!=this.label.style.display&&(this.selectWrapper.style.display="inline",this.label.style.display="none",this.element.selectedIndex<=0&&(this.inputWrapper.style.display="inline"))},this.delay)}),this.comboBox.addEventListener("mouseleave",()=>{this.element!=document.activeElement&&this.input!=document.activeElement&&this.showLabel(),"function"==typeof this.fireEvent&&this.fireEvent("mouseleave")})),this.input.addEventListener("click",e=>{"function"==typeof this.fireEvent&&this.fireEvent("click")}),this.input.addEventListener("keyup",e=>{if(13===e.which){var t=gadgetui.util.encode(this.input.value);this.handleInput(t)}"function"==typeof this.fireEvent&&this.fireEvent("keyup")}),this.hideable&&this.input.addEventListener("blur",()=>{!0===gadgetui.util.mouseWithin(this.element,gadgetui.mousePosition)?(this.inputWrapper.style.display="none",this.element.focus()):this.showLabel(),"function"==typeof this.fireEvent&&this.fireEvent("blur")}),this.hideable&&this.element.addEventListener("mouseenter",e=>{this.element.style.display="inline","function"==typeof this.fireEvent&&this.fireEvent("mouseenter")}),this.element.addEventListener("click",e=>{e.stopPropagation(),"function"==typeof this.fireEvent&&this.fireEvent("click")}),this.element.addEventListener("change",e=>{var t=e.target.selectedIndex>=0?e.target.selectedIndex:0;parseInt(e.target[t].value,10)!==parseInt(this.id,10)&&(e.target.selectedIndex>0?(this.inputWrapper.style.display="none",this.setValue(e.target[e.target.selectedIndex].value)):(this.inputWrapper.style.display="block",this.setValue(this.newOption.value),this.input.focus()),gadgetui.util.trigger(this.element,"gadgetui-combobox-change",{id:e.target[e.target.selectedIndex].value,text:e.target[e.target.selectedIndex].innerHTML}),"function"==typeof this.fireEvent&&this.fireEvent("change"))}),this.hideable&&this.element.addEventListener("blur",e=>{e.stopPropagation(),setTimeout(()=>{this.input!==document.activeElement&&this.showLabel()},200),"function"==typeof this.fireEvent&&this.fireEvent("blur")})}handleInput(e){var t=this.find(e),i=gadgetui.util.setStyle;void 0!==t?(this.element.value=t,this.label.innerText=e,this.element.focus(),this.input.value="",i(this.inputWrapper,"display","none")):void 0===t&&e.length>0&&this.save(e)}triggerSelectChange(){var e=new Event("change",{view:window,bubbles:!0,cancelable:!0});this.element.dispatchEvent(e)}setSaveFunc(){if(void 0!==this.save){var e=this.save;this.save=function(t){var i,s,n=this,a=[t];return void 0===this.find(t)&&(console.log("save: "+t),(s=new Promise(function(t,s){a.push(t),a.push(s),i=e.apply(n,a),console.log(i)})).then(function(e){function i(){!0===n.emitEvents&&gadgetui.util.trigger(n.element,"gadgetui-combobox-save",{id:e,text:t}),n.input.value="",n.inputWrapper.style.display="none",n.id=e,n.dataProvider.refresh()}!0===n.animate&&"undefined"!=typeof Velocity?(Velocity(n.selectWrapper,{boxShadow:"0 0 15px "+n.glowColor,borderColor:n.glowColor},n.animateDelay/2,function(){n.selectWrapper.style.borderColor=n.glowColor}),Velocity(n.selectWrapper,{boxShadow:0,borderColor:n.borderColor},n.animateDelay/2,i)):i()}),s.catch(function(e){n.input.value="",n.inputWrapper.hide(),console.log(e),n.dataProvider.refresh()})),i}}}setStartingValues(){void 0===this.dataProvider.data?this.dataProvider.refresh():this.setControls()}setControls(){this.setSelectOptions(),this.setValue(this.id),this.triggerSelectChange()}setValue(e){var t=this.getText(e);this.id=void 0===t?this.newOption.id:e,t=void 0===t?this.newOption.text:t,this.text=t,this.label.innerText=this.text,this.element.value=this.id}setDataProviderRefresh(){var e,t,i=this,s=this.dataProvider.refresh;this.dataProvider.refresh=function(){var n=this;return void 0!==s&&((e=new Promise(function(e,i){var a=[n,e,i];t=s.apply(this,a)})).then(function(){gadgetui.util.trigger(i.element,"gadgetui-combobox-refresh"),i.setControls()}),e.catch(function(e){console.log("message"),i.setControls()})),t}}config(e){e=void 0===e?{}:e,this.model=void 0===e.model?this.model:e.model,this.emitEvents=void 0===e.emitEvents||e.emitEvents,this.dataProvider=void 0===e.dataProvider?void 0:e.dataProvider,this.save=void 0===e.save?void 0:e.save,this.activate=void 0===e.activate?"mouseenter":e.activate,this.delay=void 0===e.delay?10:e.delay,this.borderWidth=gadgetui.util.getStyle(this.element,"border-width")||1,this.borderRadius=gadgetui.util.getStyle(this.element,"border-radius")||5,this.borderColor=gadgetui.util.getStyle(this.element,"border-color")||"silver",this.arrowWidth=e.arrowWidth||25,this.width=void 0===e.width?150:e.width,this.newOption=void 0===e.newOption?{text:"...",id:0}:e.newOption,this.id=void 0===e.id?this.newOption.id:e.id,this.scaleIconHeight=void 0!==e.scaleIconHeight&&e.scaleIconHeight,this.animate=void 0===e.animate||e.animate,this.glowColor=void 0===e.glowColor?"rgb(82, 168, 236)":e.glowColor,this.animateDelay=void 0===e.animateDelay?500:e.animateDelay,this.border=this.borderWidth+"px "+this.borderStyle+" "+this.borderColor,this.saveBorder=this.borderWidth+"px "+this.borderStyle+" "+this.glowColor,this.hideable=e.hideable||!1}},LookupListInput:class extends Component{constructor(e,t={}){super(),this.element=e,this.items=[],this.events=["added","removed","change","focus","blur","keydown","keypress","input","mousedown","menuselect","response","click"],this.config(t),this.setIsMultiLine(),this.addControl(),this.initSource(),this.addMenu(),this.addBindings()}addControl(){this.wrapper=document.createElement("div"),this.width&&gadgetui.util.setStyle(this.wrapper,"width",this.width),this.wrapper.classList.add("gadgetui-lookuplist-input"),this.element.parentNode.insertBefore(this.wrapper,this.element),this.element.parentNode.removeChild(this.element),this.wrapper.appendChild(this.element)}addMenu(){const e=document.createElement("div");e.classList.add("gadgetui-lookuplist-menu"),gadgetui.util.setStyle(e,"display","none"),this.menu={element:e},this.wrapper.appendChild(e)}initSource(){Array.isArray(this.datasource)?this.source=(e,t)=>t(this.filter(this.datasource,e.term)):"string"==typeof this.datasource?this.source=(e,t)=>{this.xhr&&this.xhr.abort(),this.xhr=fetch({url:this.datasource,data:e,dataType:"json",success:e=>t(e),error:()=>t([])})}:"function"==typeof this.datasource&&"AsyncFunction"===this.datasource.constructor.name?this.source=async(e,t)=>{try{t(await this.datasource(e))}catch(e){console.error("Error in async datasource:",e),t([])}}:this.source=this.datasource}escapeRegex(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}_filter(e,t){const i=new RegExp(this.escapeRegex(t),"i");return gadgetui.util.grep(e,e=>i.test(e.label||e.value||e))}checkForDuplicate(e){return this.items.some(t=>t===e)}setIsMultiLine(){const e=this.element.nodeName.toLowerCase();this.isMultiLine="textarea"===e||"input"!==e&&this.element.getAttribute("isContentEditable")}addBindings(){const e=this.element.nodeName.toLowerCase();let t,i,s;this.isTextarea="textarea"===e,this.isInput="input"===e,this.valueMethod=this.isTextarea||this.isInput?"value":"innerText",this.element.setAttribute("autocomplete","off"),this.wrapper.addEventListener("click",()=>{this.element.focus(),this.fireEvent("click")});const n={keydown:e=>{if(this.element.getAttribute("readOnly"))return void(t=s=i=!0);t=s=i=!1;const n=gadgetui.keyCode;switch(e.keyCode){case n.PAGE_UP:t=!0,this._move("previousPage",e);break;case n.PAGE_DOWN:t=!0,this._move("nextPage",e);break;case n.UP:t=!0,this._keyEvent("previous",e);break;case n.DOWN:t=!0,this._keyEvent("next",e);break;case n.ENTER:this.menu.active&&(t=!0,e.preventDefault(),this.menu.select(e));break;case n.BACKSPACE:!this.element.value.length&&this.items.length&&this.remove(this.element.previousSibling);break;case n.TAB:this.menu.active&&this.menu.select(e);break;case n.ESCAPE:"none"!==this.menu.element.style.display&&(this.isMultiLine||this._value(this.term),this.close(e),e.preventDefault());break;default:i=!0,this._searchTimeout(e)}this.fireEvent("keydown")},keypress:e=>{if(t)return t=!1,void(this.isMultiLine&&"none"===this.menu.element.style.display||e.preventDefault());if(i)return;const s=gadgetui.keyCode;switch(e.keyCode){case s.PAGE_UP:this._move("previousPage",e);break;case s.PAGE_DOWN:this._move("nextPage",e);break;case s.UP:this._keyEvent("previous",e);break;case s.DOWN:this._keyEvent("next",e)}this.fireEvent("keypress")},input:e=>{if(s)return s=!1,void e.preventDefault();this._searchTimeout(e),this.fireEvent("input")},focus:()=>{this.selectedItem=null,this.previous=this.element[this.valueMethod],this.fireEvent("focus")},blur:e=>{this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this.fireEvent("blur"))},change:()=>this.fireEvent("change")};Object.entries(n).forEach(([e,t])=>{this.element.addEventListener(e,t)}),this.menu.element.addEventListener("mousedown",e=>{e.preventDefault(),this.cancelBlur=!0,gadgetui.util.delay(()=>delete this.cancelBlur),this.fireEvent("mousedown")}),this.menu.element.addEventListener("menuselect",e=>{const t=e.detail,i=this.previous;this.menu.element!==document.activeElement&&(this.menu.element.focus(),this.previous=i,gadgetui.util.delay(()=>{this.previous=i,this.selectedItem=t})),this._value(t.value),this.term=this._value(),this.close(e),this.selectedItem=t,this.add(t),this.fireEvent("menuselect")})}_renderItem(e){const t=document.createElement("div");t.classList.add("gadgetui-lookuplist-input-item-wrapper");const i=document.createElement("div");return i.classList.add("gadgetui-lookuplist-input-item"),i.innerHTML=this.labelRenderer(e),t.appendChild(i),t}_renderItemCancel(e,t){const i=gadgetui.util.setStyle,s=document.createElement("span"),n=gadgetui.util.getNumberValue(gadgetui.util.getStyle(t,"width"))+6;return s.classList.add("oi"),s.setAttribute("data-glyph","circle-x"),i(s,"opacity",".5"),i(s,"left",n),i(s,"position","absolute"),i(s,"cursor","pointer"),i(s,"top",3),s}add(e){const t=this.itemRenderer(e);t.setAttribute("data-value",e.value),this.wrapper.insertBefore(t,this.element);const i=this.itemCancelRenderer(e,t);if(i&&(t.appendChild(i),i.addEventListener("click",()=>this.remove(t))),this.element.value="",this.items.push(e),this.fireEvent("added"),this.emitEvents&&gadgetui.util.trigger(this.element,"gadgetui-lookuplist-input-add",e),this.func&&this.func(e,"add"),this.model){const t=this.element.getAttribute("gadgetui-bind");if(t){const i=this.model.get(t)||[];i.push(e),this.model.set(t,i)}}}remove(e){const t=e.getAttribute("data-value");e.parentNode.removeChild(e);const i=this.items.findIndex(e=>e.value===t);if(-1!==i){const[e]=this.items.splice(i,1);if(this.model){const i=this.element.getAttribute("gadgetui-bind");if(i){const s=this.model.get(i),n=s.findIndex(e=>e.value===t);-1!==n&&(s.splice(n,1),this.func&&this.func(e,"remove"),this.emitEvents&&gadgetui.util.trigger(this.element,"gadgetui-lookuplist-input-remove",e),this.model.set(i,s))}}this.fireEvent("removed")}}reset(){for(;this.wrapper.firstChild&&this.wrapper.firstChild!==this.element;)this.wrapper.removeChild(this.wrapper.firstChild);if(this.items=[],this.model){const e=this.element.getAttribute("gadgetui-bind");e&&this.model.set(e,[])}}destroy(){clearTimeout(this.searching),this.menu.element.remove(),this.liveRegion&&this.liveRegion.remove()}_setOption(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()}_appendTo(){let e=this.options.appendTo;return e||(e=this.element.closest(".ui-front")||document.body),e.jquery||e.nodeType?$(e):this.document.find(e).eq(0)}_searchTimeout(e){clearTimeout(this.searching),this.searching=gadgetui.util.delay(()=>{const t=this.term!==this.element.value,i="none"!==this.menu.element.style.display,s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;!t&&(t||i||s)||(this.selectedItem=null,this.search(null,e))},this.delay)}search(e,t){return e=e??this.element.value,this.term=this._value(),e.length<this.minLength?this.close(t):this._search(e)}_search(e){this.pending++,this.cancelSearch=!1,this.source({term:e},this._response())}_response(){const e=++this.requestIndex;return t=>{e===this.requestIndex&&(this.__response(t),this.pending--)}}__response(e){(!this.labelRenderer||this.labelRenderer===this._renderLabel)&&e?.length&&(e=this._normalize(e)),this.element.dispatchEvent(new CustomEvent("response",{detail:{content:e}})),this.fireEvent("response",e),this.disabled||!e?.length||this.cancelSearch||this.suppressSuggestions?this._close():(this._suggest(e),this.element.dispatchEvent(new Event("open")))}close(e){this.cancelSearch=!0,this._close(e)}_close(){"none"!==this.menu.element.style.display&&(this.menu.element.style.display="none",this.menu.element.blur(),this.isNewMenu=!0)}_normalize(e){return e.length&&e[0].label&&e[0].value?e:e.map(e=>"string"==typeof e?{label:e,value:e}:{label:e.label||e.value,value:e.value||e.label})}_suggest(e){const t=this.menu.element;for(;t.firstChild;)t.removeChild(t.firstChild);this._renderMenu(e),t.style.display="block",this._resizeMenu(),this.position.of=this.element,this.isNewMenu=!0}_resizeMenu(){}_renderMenu(e){const t=Math.min(this.maxSuggestions,e.length);for(let i=0;i<t;i++)this._renderItemData(e[i])}_renderItemData(e){const t=this.menuItemRenderer(e);t.addEventListener("click",()=>{this.menu.element.dispatchEvent(new CustomEvent("menuselect",{detail:e}))}),this.menu.element.appendChild(t)}_renderMenuItem(e){const t=document.createElement("div");return t.classList.add("gadgetui-lookuplist-item"),t.setAttribute("value",e.value),t.innerText=this.labelRenderer(e),t}_renderLabel(e){return e.label}_move(e,t){if("none"!==this.menu.element.style.display)return this.menu.element.isFirstItem()&&/^previous/.test(e)||this.menu.element.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)}widget(){return this.menu.element}_value(e){return void 0!==e&&(this.element[this.valueMethod]=e),this.element[this.valueMethod]}_keyEvent(e,t){this.isMultiLine&&"none"===this.menu.element.style.display||(this._move(e,t),t.preventDefault())}config(e){this.model=this.element.getAttribute("gadgetui-bind")&&!e.model?gadgetui.model:e.model,this.width=e.width,this.func=e.func,this.filter=e.filter||this._filter,this.labelRenderer=e.labelRenderer||this._renderLabel,this.itemRenderer=e.itemRenderer||this._renderItem,this.menuItemRenderer=e.menuItemRenderer||this._renderMenuItem,this.itemCancelRenderer=e.itemCancelRenderer||this._renderItemCancel,this.emitEvents=e.emitEvents??!0,this.datasource=e.datasource??(e.lookupList||!0),this.minLength=e.minLength||0,this.disabled=e.disabled||!1,this.maxSuggestions=e.maxSuggestions||20,this.position=e.position||{my:"left top",at:"left bottom",collision:"none"},this.suppressSuggestions=e.suppressSuggestions||!1,this.autoFocus=e.autoFocus||!1,this.requestIndex=0,this.delay=e.delay||300}},Toggle:class extends Component{constructor(e){super(),this.configure(e),this.create()}configure(e){this.selector=e.selector,this.parentSelector=e.parentSelector,this.shape=void 0===e.shape?"square":e.shape,this.value=1===parseInt(e.initialValue,10)?1:0}create(){if(void 0!==this.selector)this.element=document.querySelector(this.selector);else{const e=document.createElement("input");e.type="range",e.min=0,e.max=1,document.querySelector(this.parentSelector).appendChild(e),this.element=e}this.element.value=this.value,this.element.classList.add("gadget-ui-toggle"),"round"===this.shape&&this.element.classList.add("gadget-ui-toggle-round"),0===this.value&&this.element.classList.add("gadget-ui-toggle-off"),this.element.addEventListener("click",function(){1===this.value?(this.value=0,this.element.classList.add("gadget-ui-toggle-off")):(this.value=1,this.element.classList.remove("gadget-ui-toggle-off")),this.element.value=this.value,this.fireEvent("changed")}.bind(this))}}},gadgetui.objects=function(){var e={on:function(e,t){return void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this},off:function(e){return this.events[e]=[],this},fireEvent:function(e,t){var i=this;void 0!==this.events[e]&&this.events[e].forEach(function(e){e(i,t)})},getAll:function(){return[{name:"on",func:this.on},{name:"off",func:this.off},{name:"fireEvent",func:this.fireEvent}]}};function t(e){this.set(e)}return t.prototype.set=function(e){this.fileid=void 0!==e.fileid?e.fileid:"",this.filename=void 0!==e.filename?e.filename:"",void 0!==e.filename?(this.filenameabbr=e.filename.substr(0,25),e.filename.length>25&&(this.filenameabbr=this.filenameabbr+"...")):this.filenameabbr="",this.filesize=void 0!==e.filesize?e.filesize:"",this.tags=void 0!==e.tags?e.tags:"",this.path=void 0!==e.path?e.path:"",this.created=void 0!==e.created?e.created:"",this.createdStr=void 0!==e.created?e.createdStr:"",this.disabled=void 0!==e.disabled?e.disabled:0,this.mimetype=void 0!==e.mimetype?e.mimetype:"application/x-unknown",this.tile=void 0!==e.tile?e.tile:""},{Constructor:function(t,i,s){var n,a,o,r;if(!0===s)for(r=e.getAll(),n=0;n<r.length;n++)void 0===t.prototype[r[n].name]&&(t.prototype[r[n].name]=r[n].func);if(o=Object.create(t.prototype),void 0===(a=t.apply(o,i))&&(a=o),!0===s)for(a.events={},n=0;n<t.prototype.events.length;n++)a.events[t.prototype.events[n]]=[];return a},EventBindings:e,FileItem:t}}(),gadgetui.util=function(){const e={debug:!1,align:"center",vAlign:"middle",fontSize:14,fontWeight:"",fontStyle:"",fontVariant:"",font:"Arial",lineHeight:null,justify:!1};return{split:function(e){return e.split(/,\s*/)},extractLast:function(e){return this.split(e).pop()},getNumberValue:function(e){return isNaN(Number(e))?Number(e.substring(0,e.length-2)):e},checkBrowser:function(){var e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t="undefined"!=typeof InstallTrigger,i=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),s=!!document.documentMode,n=!s&&!!window.StyleMedia,a=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);let o="generic";return e&&(o="opera"),t&&(o="firefox"),i&&(o="safari"),s&&(o="ie"),n&&(o="edge"),a&&(o="chrome"),a&&-1!=navigator.userAgent.indexOf("Edg")&&(o="edgechromium"),(a||e)&&!!window.CSS&&(o="blink"),o},getOffset:function(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},getParentsUntil:function(e,t,i){var s=[];if(t)var n=t.charAt(0);if(i)var a=i.charAt(0);for(;e&&e!==document;e=e.parentNode){if(t){if("."===n&&e.classList.contains(t.substr(1)))break;if("#"===n&&e.id===t.substr(1))break;if("["===n&&e.hasAttribute(t.substr(1,t.length-1)))break;if(e.tagName.toLowerCase()===t)break}i?("."===a&&e.classList.contains(i.substr(1))&&s.push(e),"#"===a&&e.id===i.substr(1)&&s.push(e),"["===a&&e.hasAttribute(i.substr(1,i.length-1))&&s.push(e),e.tagName.toLowerCase()===i&&s.push(e)):s.push(e)}return 0===s.length?null:s},getRelativeParentOffset:function(e){var t,i,s=gadgetui.util.getParentsUntil(e,"body"),n=0,a=0;for(t=0;t<s.length;t++)"relative"===s[t].style.position&&((i=gadgetui.util.getOffset(s[t])).left>n&&(n=i.left),i.top>a&&(a=i.top));return{left:n,top:a}},Id:function(){return(100*Math.random()).toString().replace(/\./g,"")},bind:function(e,t){var i=e.getAttribute("gadgetui-bind");null!=i&&void 0!==t&&t.bind(i,e)},mouseCoords:function(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+document.body.scrollLeft-document.body.clientLeft,y:e.clientY+document.body.scrollTop-document.body.clientTop}},mouseWithin:function(e,t){var i=e.getBoundingClientRect();return t.x>=i.left&&t.x<=i.right&&t.y>=i.top&&t.y<=i.bottom},getStyle:function(e,t){return void 0!==window.getComputedStyle?void 0!==t?window.getComputedStyle(e,null).getPropertyValue(t):window.getComputedStyle(e,null):void 0!==t?e.currentStyle[t]:e.currentStyle},draggable:function(e){var t=null,i=0,s=0,n=0,a=0;e.onmousedown=function(){return n=i-(t=this).offsetLeft,a=s-t.offsetTop,!1},document.onmousemove=function(e){i=document.all?window.event.clientX:e.pageX,s=document.all?window.event.clientY:e.pageY,null!==t&&(t.style.left=i-n+"px",t.style.top=s-a+"px")},document.onmouseup=function(i){console.log(i);var s=new CustomEvent("drag_end",{detail:{top:gadgetui.util.getStyle(e,"top"),left:gadgetui.util.getStyle(e,"left")}});e.dispatchEvent(s),t=null}},textWidth:function(e,t){gadgetui.util.textWidthEl||(gadgetui.util.textWidthEl=document.createElement("div"),gadgetui.util.textWidthEl.setAttribute("id","gadgetui-textWidth"),gadgetui.util.textWidthEl.setAttribute("style","display: none;"),document.body.appendChild(gadgetui.util.textWidthEl));var i,s=e;return s.length>0&&(gadgetui.util.textWidthEl.innerText=s,s=void 0===s?"":s.replace(/\s/g,"&nbsp;")),gadgetui.util.textWidthEl.innertText=s,gadgetui.util.textWidthEl.style.fontFamily=t.fontFamily,gadgetui.util.textWidthEl.style.fontSize=t.fontSize,gadgetui.util.textWidthEl.style.fontWeight=t.fontWeight,gadgetui.util.textWidthEl.style.fontVariant=t.fontVariant,gadgetui.util.textWidthEl.style.display="inline",i=gadgetui.util.textWidthEl.offsetWidth,gadgetui.util.textWidthEl.style.display="none",i},fitText:function(e,t,i){var s,n=gadgetui.util.TextWidth(e,t),a=gadgetui.util.TextWidth("...",t);if(n<i)return e;for(s=Math.floor(e.length/2)-1;n+a>=i;)e=e.slice(0,s)+e.slice(s+1,e.length),s=Math.floor(e.length/2)-1,n=gadgetui.util.TextWidth(e,font);for(s=Math.floor(e.length/2)-1,e=e.slice(0,s)+"..."+e.slice(s,e.length);" "===e.substring(s-1,s);)e=e.slice(0,s-1)+e.slice(s,e.length),s-=1;for(;" "===e.substring(s+3,s+4);)e=e.slice(0,s+3)+e.slice(s+4,e.length),s-=1;return e},createElement:function(e){var t=document.createElement(e);return t.setAttribute("style",""),t},addStyle:function(e,t){var i=e.getAttribute("style"),s=null!==i?i:"";e.setAttribute("style",s+" "+t+";")},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},setStyle:function(e,t,i){var s,n=e.getAttribute("style"),a=null!==n?n:"",o=new RegExp("("+t+")+ *\\:[^\\;]*\\;","g");if(!0===gadgetui.util.isNumeric(i))switch(t){case"opacity":case"z-index":case"font-weight":break;default:i+="px"}s=a.search(o)>=0?a.replace(o,t+": "+i+";"):a+" "+t+": "+i+";",e.setAttribute("style",s)},encode:function(e){return e},trigger:function(e,t,i){e.dispatchEvent(new CustomEvent(t,{detail:i}))},getMaxZIndex:function(){for(var e=document.querySelectorAll("*"),t=0,i=0;i<e.length;i++){var s=gadgetui.util.getStyle(e[i],"z-index");s>t&&"auto"!=s&&(t=s)}return t},grep:function(e,t,i){for(var s=[],n=0,a=e.length,o=!i;n<a;n++)!t(e[n],n)!==o&&s.push(e[n]);return s},delay:function(e,t){var i=this;return setTimeout(function(){return e.apply(i,arguments)},t||0)},contains:function(e,t){for(var i=e.parentNode;null!=i;){if(i==t)return!0;i=i.parentNode}return!1},B:function({ctx:e,line:t,spaceWidth:i,spaceChar:s,width:n}){const a=t.trim(),o=a.split(/\s+/),r=o.length-1;if(0===r)return a;const l=(n-e.measureText(o.join("")).width)/i,h=Math.floor(l/r);if(l<1)return a;const d=s.repeat(h);return o.join(d)},splitText:function({ctx:e,text:t,justify:i,width:s}){const n=new Map,a=t=>{let i=n.get(t);return void 0!==i||(i=e.measureText(t).width,n.set(t,i)),i};let o=[],r=t.split("\n\t\t  ");const l=i?a(""):0;let h=0,d=0;for(const t of r){let n=a(t);const r=t.length;if(n<=s){o.push(t);continue}let u,c,g=t,p="";for(;n>s;){if(h++,u=d,c=0===u?0:a(t.substring(0,u)),c<s)for(;c<s&&u<r&&(u++,c=a(g.substring(0,u)),u!==r););else if(c>s)for(;c>s&&(u=Math.max(1,u-1),c=a(g.substring(0,u)),0!==u&&1!==u););if(d=Math.round(d+(u-d)/h),u--,u>0){let e=u;if(" "!=g.substring(e,e+1)){for(;" "!=g.substring(e,e+1)&&e>=0;)e--;e>0&&(u=e)}}0===u&&(u=1),p=g.substring(0,u),p=i?gadgetui.util.B({ctx:e,line:p,spaceWidth:l,spaceChar:"",width:s}):p,o.push(p),g=g.substring(u),n=a(g)}n>0&&(p=i?gadgetui.util.B({ctx:e,line:g,spaceWidth:l,spaceChar:"",width:s}):g,o.push(p))}return o},getTextHeight:function({ctx:e,text:t,style:i}){const s=e.textBaseline,n=e.font;e.textBaseline="bottom",e.font=i;const{actualBoundingBoxAscent:a}=e.measureText(t);return e.textBaseline=s,e.font=n,a},drawText:function(t,i,s){const{width:n,height:a,x:o,y:r}=s,l={...e,...s};if(n<=0||a<=0||l.fontSize<=0)return{height:0};const h=o+n,d=r+a,{fontStyle:u,fontVariant:c,fontWeight:g,fontSize:p,font:m}=l,f=`${u} ${c} ${g} ${p}px ${m}`;t.font=f;let v,b=r+a/2+l.fontSize/2;"right"===l.align?(v=h,t.textAlign="right"):"left"===l.align?(v=o,t.textAlign="left"):(v=o+n/2,t.textAlign="center");const y=gadgetui.util.splitText({ctx:t,text:i,justify:l.justify,width:n}),x=l.lineHeight?l.lineHeight:gadgetui.util.getTextHeight({ctx:t,text:"M",style:f}),E=x*(y.length-1),w=E/2;let C=r;if("top"===l.vAlign?(t.textBaseline="top",b=r):"bottom"===l.vAlign?(t.textBaseline="bottom",b=d-E,C=d):(t.textBaseline="bottom",C=r+a/2,b-=w),y.forEach(e=>{e=e.trim(),t.fillText(e,v,b),b+=x}),l.debug){const e="#0C8CE9";t.lineWidth=1,t.strokeStyle=e,t.strokeRect(o,r,n,a),t.lineWidth=1,t.strokeStyle=e,t.beginPath(),t.moveTo(v,r),t.lineTo(v,d),t.stroke(),t.strokeStyle=e,t.beginPath(),t.moveTo(o,C),t.lineTo(h,C),t.stroke()}return{height:E+x}}}}();export gadgetui=gadgetui;export var model=gadgetui.model;export var display=gadgetui.display;export var input=gadgetui.input;export var bubble=gadgetui.display.Bubble;export var collapsiblepane=gadgetui.display.CollapsiblePane;export var dialog=gadgetui.display.Dialog;export var fileuploadwrapper=gadgetui.display.FileUploadWrapper;export var floatingpane=gadgetui.display.FloatingPane;export var lightbox=gadgetui.display.Lightbox;export var menu=gadgetui.display.Menu;export var modal=gadgetui.display.Modal;export var overlay=gadgetui.display.Overlay;export var popover=gadgetui.display.Popover;export var progressbar=gadgetui.display.ProgressBar;export var sidebar=gadgetui.display.Sidebar;export var tabs=gadgetui.display.Tabs;export var autosuggest=gadgetui.input.Autosuggest;export var combobox=gadgetui.input.ComboBox;export var fileuploader=gadgetui.input.FileUploader;export var lookuplistinput=gadgetui.input.LookupListInput;export var selectinput=gadgetui.input.SelectInput;export var textinput=gadgetui.input.TextInput;export var toggle=gadgetui.input.Toggle;export var component=gadgetui.objects.Component;export var util=gadgetui.util;